
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Library for Data Quality checks">
      
      
        <meta name="author" content="Demetrius Albuquerque">
      
      
      
        <link rel="prev" href="../cli/">
      
      
        <link rel="next" href="../services/services/">
      
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>core - Sumeh DQ — Unified Data Quality Framework</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-sumehcore" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-header__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../img/sumeh.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sumeh DQ — Unified Data Quality Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              core
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-nav__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../img/sumeh.svg" alt="logo">

    </a>
    Sumeh DQ — Unified Data Quality Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__detect_engine" class="md-nav__link">
    <span class="md-ellipsis">
      __detect_engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_glue_data_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_glue_data_catalog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_rules_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_rules_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_glue" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_glue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/services-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/services-utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    engines
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            engines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    engine overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-dask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dask engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-duckdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    duckDB engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-pandas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pandas engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polars engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-pyspark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pyspark engine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__detect_engine" class="md-nav__link">
    <span class="md-ellipsis">
      __detect_engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_glue_data_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_glue_data_catalog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_rules_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_rules_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_glue" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_glue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="module-sumehcore">Module <code>sumeh.core</code><a class="headerlink" href="#module-sumehcore" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>This module provides a set of functions and utilities for data validation, schema
retrieval, and summarization. It supports multiple data sources and engines,
including BigQuery, S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB, and Databricks.</p>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_rules_config(source, **kwargs) (sumeh.core.get_rules_config)" href="#sumeh.core.get_rules_config">get_rules_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, **kwargs) -&gt; List[Dict[str, Any]]:
Retrieves configuration rules based on the specified source.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_schema_config(source, **kwargs) (sumeh.core.get_schema_config)" href="#sumeh.core.get_schema_config">get_schema_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, **kwargs) -&gt; List[Dict[str, Any]]:
Retrieves the schema configuration based on the provided data source.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__detect_engine(df) (sumeh.core.__detect_engine)" href="#sumeh.core.__detect_engine">__detect_engine</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate_schema(df_or_conn, expected, engine, **engine_kwargs) (sumeh.core.validate_schema)" href="#sumeh.core.validate_schema">validate_schema</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Any, expected: List[Dict[str, Any]], engine: str, **engine_kwargs) -&gt; Tuple[bool, List[Tuple[str, str]]]:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate(df, rules, **context) (sumeh.core.validate)" href="#sumeh.core.validate">validate</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="summarize(df, rules, **context) (sumeh.core.summarize)" href="#sumeh.core.summarize">summarize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>list[dict], **context):</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="report(df, rules, name='Quality Check') (sumeh.core.report)" href="#sumeh.core.report">report</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>list[dict], name: str = "Quality Check"):</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="imports" open>
  <summary>Imports</summary>
  <p>cuallee: Provides the <code>Check</code> and <code>CheckLevel</code> classes for data validation.
warnings: Used to issue warnings for unknown rule names.
importlib: Dynamically imports modules based on engine detection.
typing: Provides type hints for function arguments and return values.
re: Used for regular expression matching in source string parsing.
sumeh.services.config: Contains functions for retrieving configurations and schemas
  from various data sources.
sumeh.services.utils: Provides utility functions for value conversion and URI parsing.</p>
<p>The module uses Python's structural pattern matching (<code>match-case</code>) to handle
different data source types and validation rules.
The <code>report</code> function supports a wide range of validation checks, including
completeness, uniqueness, value comparisons, patterns, and date-related checks.
The <code>validate</code> and <code>summarize</code> functions dynamically detect the appropriate engine
based on the input DataFrame type and delegate the processing to the corresponding
engine module.</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="sumeh.core.__convert_value" class="doc doc-heading">
            <code class=" language-python"><span class="n">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#sumeh.core.__convert_value" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts the provided value to the appropriate type (date, float, or int).</p>
<p>Depending on the format of the input value, it will be converted to a datetime object,
a floating-point number (float), or an integer (int).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be converted, represented as a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the value does not match an expected format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the provided value to the appropriate type (date, float, or int).</span>

<span class="sd">    Depending on the format of the input value, it will be converted to a datetime object,</span>
<span class="sd">    a floating-point number (float), or an integer (int).</span>

<span class="sd">    Args:</span>
<span class="sd">        value (str): The value to be converted, represented as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the value does not match an expected format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.__detect_engine" class="doc doc-heading">
            <code class=" language-python"><span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

<a href="#sumeh.core.__detect_engine" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Detects the engine type of the given DataFrame based on its module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame object whose engine type is to be detected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the detected engine type. Possible values are:
- "pyspark_engine" for PySpark DataFrames
- "dask_engine" for Dask DataFrames
- "polars_engine" for Polars DataFrames
- "pandas_engine" for Pandas DataFrames
- "duckdb_engine" for DuckDB or BigQuery DataFrames</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the DataFrame type is unsupported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detects the engine type of the given DataFrame based on its module.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: The DataFrame object whose engine type is to be detected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representing the detected engine type. Possible values are:</span>
<span class="sd">            - &quot;pyspark_engine&quot; for PySpark DataFrames</span>
<span class="sd">            - &quot;dask_engine&quot; for Dask DataFrames</span>
<span class="sd">            - &quot;polars_engine&quot; for Polars DataFrames</span>
<span class="sd">            - &quot;pandas_engine&quot; for Pandas DataFrames</span>
<span class="sd">            - &quot;duckdb_engine&quot; for DuckDB or BigQuery DataFrames</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the DataFrame type is unsupported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span>
    <span class="k">match</span> <span class="n">mod</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pyspark&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;pyspark_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dask&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;dask_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;polars&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;polars_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pandas&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;pandas_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;duckdb&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;duckdb_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bigquery&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;duckdb_engine&quot;</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported DataFrame type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_bigquery" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_bigquery</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">table_id</span><span class="p">,</span> <span class="n">credentials_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_bigquery" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a Google BigQuery table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>project_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Google Cloud project ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery dataset ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery table ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to service account credentials file (if not provided, defaults to default credentials).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if not provided, defaults to SELECT *).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error while querying BigQuery.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_bigquery</span><span class="p">(</span>
    <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a Google BigQuery table.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): Google Cloud project ID.</span>
<span class="sd">        dataset_id (str): BigQuery dataset ID.</span>
<span class="sd">        table_id (str): BigQuery table ID.</span>
<span class="sd">        credentials_path (Optional[str]): Path to service account credentials file (if not provided, defaults to default credentials).</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, defaults to SELECT *).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error while querying BigQuery.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">bigquery</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.oauth2</span><span class="w"> </span><span class="kn">import</span> <span class="n">service_account</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.auth.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">DefaultCredentialsError</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table_id</span><span class="si">}</span><span class="s2">`&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">credentials_path</span><span class="p">:</span>
            <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
                <span class="n">credentials_path</span>
            <span class="p">)</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">DefaultCredentialsError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Credentials error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error occurred while querying BigQuery: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_csv" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_csv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a CSV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local file path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The delimiter used in the CSV file (default is ",").</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error reading or processing the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_csv</span><span class="p">(</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The local file path to the CSV file.</span>
<span class="sd">        delimiter (Optional[str]): The delimiter used in the CSV file (default is &quot;,&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error reading or processing the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">__read_local_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">__read_csv_file</span><span class="p">(</span><span class="n">file_content</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39; not found. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error while parsing CSV file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Catch any unexpected exceptions</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected error while processing CSV file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_databricks" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_databricks</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_databricks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a Databricks table and returns it as a list of dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark SparkSession</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spark Session to get information from Databricks</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The catalog name in Databricks. If provided, it will be included in the table's full path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The schema name in Databricks. If provided, it will be included in the table's full path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table to retrieve data from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (currently unused).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries, where each dictionary represents a row of data from the table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_databricks</span><span class="p">(</span>
    <span class="n">spark</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a Databricks table and returns it as a list of dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        spark SparkSession: Spark Session to get information from Databricks</span>
<span class="sd">        catalog (Optional[str]): The catalog name in Databricks. If provided, it will be included in the table&#39;s full path.</span>
<span class="sd">        schema (Optional[str]): The schema name in Databricks. If provided, it will be included in the table&#39;s full path.</span>
<span class="sd">        table (str): The name of the table to retrieve data from.</span>
<span class="sd">        query: Additional keyword arguments (currently unused).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries, where each dictionary represents a row of data from the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">catalog</span> <span class="ow">and</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">table</span>
    <span class="k">if</span> <span class="s2">&quot;query&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;select * from </span><span class="si">{</span><span class="n">full</span><span class="si">}</span><span class="s2"> where </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_duckdb" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_duckdb</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_duckdb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve configuration data from a DuckDB database.</p>
<p>This function fetches data from a DuckDB database either by executing a custom SQL query
or by selecting all rows from a specified table. The data is then parsed into a list of
dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table to fetch data from. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A custom SQL query to execute. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A valid DuckDB connection object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the fetched data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>table</code> nor <code>query</code> is provided, or if a valid <code>conn</code> is not supplied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import duckdb
conn = duckdb.connect('my_db.duckdb')
config = get_config_from_duckdb('my_db.duckdb', table='rules', conn=conn)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_duckdb</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve configuration data from a DuckDB database.</span>

<span class="sd">    This function fetches data from a DuckDB database either by executing a custom SQL query</span>
<span class="sd">    or by selecting all rows from a specified table. The data is then parsed into a list of</span>
<span class="sd">    dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str, optional): The name of the table to fetch data from. Defaults to None.</span>
<span class="sd">        query (str, optional): A custom SQL query to execute. Defaults to None.</span>
<span class="sd">        conn: A valid DuckDB connection object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the fetched data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `table` nor `query` is provided, or if a valid `conn` is not supplied.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import duckdb</span>
<span class="sd">        &gt;&gt;&gt; conn = duckdb.connect(&#39;my_db.duckdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; config = get_config_from_duckdb(&#39;my_db.duckdb&#39;, table=&#39;rules&#39;, conn=conn)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">table</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;DuckDB configuration requires:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;1. Either a `table` name or custom `query`</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;2. A valid database `conn` connection object</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Example: get_config(&#39;duckdb&#39;, table=&#39;rules&#39;, conn=duckdb.connect(&#39;my_db.duckdb&#39;))&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_glue_data_catalog" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_glue_data_catalog</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_glue_data_catalog" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from AWS Glue Data Catalog.</p>
<p>Using Spark directly - works with all table formats (Parquet, ORC, CSV, Iceberg, Delta, Hudi).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>glue_context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <code>GlueContext</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Glue database name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Glue table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if provided).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error querying Glue Data Catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_glue_data_catalog</span><span class="p">(</span>
    <span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from AWS Glue Data Catalog.</span>

<span class="sd">    Using Spark directly - works with all table formats (Parquet, ORC, CSV, Iceberg, Delta, Hudi).</span>

<span class="sd">    Args:</span>
<span class="sd">        glue_context: An instance of `GlueContext`.</span>
<span class="sd">        database_name (str): Glue database name.</span>
<span class="sd">        table_name (str): Glue table name.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if provided).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error querying Glue Data Catalog.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">awsglue.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlueContext</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">GlueContext</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided context is not a valid GlueContext.&quot;</span><span class="p">)</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">glue_context</span><span class="o">.</span><span class="n">spark_session</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">full_table_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s2">`.`</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">`&quot;</span>

        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">full_table_name</span><span class="p">)</span>
            <span class="n">data_frame</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;temp_table_view&quot;</span><span class="p">)</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">full_table_name</span><span class="p">)</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">collect</span><span class="p">()]</span>

        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error occurred while querying Glue Data Catalog &#39;</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_mysql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_mysql</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_mysql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a MySQL database.
Args:
    connection (Optional): An existing MySQL connection object.
    host (Optional[str]): Host of the MySQL server.
    user (Optional[str]): Username to connect to MySQL.
    password (Optional[str]): Password for the MySQL user.
    database (Optional[str]): Database name to query.
    port (Optional[int]): The port for the MySQL connection (default is 3306).
    schema (Optional[str]): Schema name if query is not provided.
    table (Optional[str]): Table name if query is not provided.
    query (Optional[str]): Custom SQL query to fetch data (if not provided, <code>schema</code> and <code>table</code> must be given).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>query</code> nor both <code>schema</code> and <code>table</code> are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ConnectionError">ConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error connecting to MySQL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error executing the query or processing the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_mysql</span><span class="p">(</span>
    <span class="n">connection</span><span class="p">:</span> <span class="n">Optional</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a MySQL database.</span>
<span class="sd">    Args:</span>
<span class="sd">        connection (Optional): An existing MySQL connection object.</span>
<span class="sd">        host (Optional[str]): Host of the MySQL server.</span>
<span class="sd">        user (Optional[str]): Username to connect to MySQL.</span>
<span class="sd">        password (Optional[str]): Password for the MySQL user.</span>
<span class="sd">        database (Optional[str]): Database name to query.</span>
<span class="sd">        port (Optional[int]): The port for the MySQL connection (default is 3306).</span>
<span class="sd">        schema (Optional[str]): Schema name if query is not provided.</span>
<span class="sd">        table (Optional[str]): Table name if query is not provided.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, `schema` and `table` must be given).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `query` nor both `schema` and `table` are provided.</span>
<span class="sd">        ConnectionError: If there is an error connecting to MySQL.</span>
<span class="sd">        RuntimeError: If there is an error executing the query or processing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">mysql.connector</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;You must provide either a &#39;query&#39; or both &#39;schema&#39; and &#39;table&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="ow">or</span> <span class="n">__create_connection</span><span class="p">(</span>
            <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">port</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error connecting to MySQL database: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error executing the query or processing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connection</span> <span class="ow">and</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_postgresql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_postgresql</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_postgresql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a PostgreSQL database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>connection</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An existing PostgreSQL connection object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Host of the PostgreSQL server.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Username to connect to PostgreSQL.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for the PostgreSQL user.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database name to query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The port for the PostgreSQL connection (default is 5432).</p>
              </div>
            </td>
            <td>
                  <code>5432</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if not provided, <code>schema</code> and <code>table</code> must be given).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>query</code> nor both <code>schema</code> and <code>table</code> are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ConnectionError">ConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error connecting to PostgreSQL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error executing the query or processing the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_postgresql</span><span class="p">(</span>
    <span class="n">connection</span><span class="p">:</span> <span class="n">Optional</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5432</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a PostgreSQL database.</span>

<span class="sd">    Args:</span>
<span class="sd">        connection (Optional): An existing PostgreSQL connection object.</span>
<span class="sd">        host (Optional[str]): Host of the PostgreSQL server.</span>
<span class="sd">        user (Optional[str]): Username to connect to PostgreSQL.</span>
<span class="sd">        password (Optional[str]): Password for the PostgreSQL user.</span>
<span class="sd">        database (Optional[str]): Database name to query.</span>
<span class="sd">        port (Optional[int]): The port for the PostgreSQL connection (default is 5432).</span>
<span class="sd">        schema (Optional[str]): Schema name if query is not provided.</span>
<span class="sd">        table (Optional[str]): Table name if query is not provided.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, `schema` and `table` must be given).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `query` nor both `schema` and `table` are provided.</span>
<span class="sd">        ConnectionError: If there is an error connecting to PostgreSQL.</span>
<span class="sd">        RuntimeError: If there is an error executing the query or processing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">psycopg2</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;You must provide either a &#39;query&#39; or both &#39;schema&#39; and &#39;table&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="ow">or</span> <span class="n">__create_connection</span><span class="p">(</span>
            <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">port</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error connecting to PostgreSQL database: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error executing the query or processing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connection</span> <span class="ow">and</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_s3" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_s3" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a CSV file stored in an S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>s3_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The delimiter used in the CSV file (default is ",").</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error reading or processing the S3 file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a CSV file stored in an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        s3_path (str): The S3 path to the CSV file.</span>
<span class="sd">        delimiter (Optional[str]): The delimiter used in the CSV file (default is &quot;,&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error reading or processing the S3 file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">__read_s3_file</span><span class="p">(</span><span class="n">s3_path</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">__read_csv_file</span><span class="p">(</span><span class="n">file_content</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading or processing the S3 file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_rules_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_rules_config</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_rules_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve configuration rules based on the specified source.</p>
<p>Dispatches to the appropriate loader according to the format of <code>source</code>,
returning a list of parsed rule dictionaries.</p>


<details class="supported-sources" open>
  <summary>Supported sources</summary>
  <ul>
<li><code>bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;</code></li>
<li><code>s3://&lt;bucket&gt;/&lt;path&gt;</code></li>
<li><code>&lt;file&gt;.csv</code></li>
<li><code>"mysql"</code> or <code>"postgresql"</code> (requires host/user/etc. in kwargs)</li>
<li><code>"glue"</code> (AWS Glue Data Catalog)</li>
<li><code>duckdb://&lt;db_path&gt;.&lt;table&gt;</code></li>
<li><code>databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;</code></li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier of the rules configuration location. Determines which
handler is invoked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loader-specific parameters (e.g. <code>host</code>, <code>user</code>, <code>password</code>,
<code>connection</code>, <code>query</code>).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]:
A list of dictionaries, each representing a validation rule with keys
like <code>"field"</code>, <code>"check_type"</code>, <code>"value"</code>, <code>"threshold"</code>, and <code>"execute"</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>source</code> does not match any supported format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rules_config</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve configuration rules based on the specified source.</span>

<span class="sd">    Dispatches to the appropriate loader according to the format of `source`,</span>
<span class="sd">    returning a list of parsed rule dictionaries.</span>

<span class="sd">    Supported sources:</span>
<span class="sd">      - `bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;`</span>
<span class="sd">      - `s3://&lt;bucket&gt;/&lt;path&gt;`</span>
<span class="sd">      - `&lt;file&gt;.csv`</span>
<span class="sd">      - `&quot;mysql&quot;` or `&quot;postgresql&quot;` (requires host/user/etc. in kwargs)</span>
<span class="sd">      - `&quot;glue&quot;` (AWS Glue Data Catalog)</span>
<span class="sd">      - `duckdb://&lt;db_path&gt;.&lt;table&gt;`</span>
<span class="sd">      - `databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;`</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str):</span>
<span class="sd">            Identifier of the rules configuration location. Determines which</span>
<span class="sd">            handler is invoked.</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Loader-specific parameters (e.g. `host`, `user`, `password`,</span>
<span class="sd">            `connection`, `query`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]:</span>
<span class="sd">            A list of dictionaries, each representing a validation rule with keys</span>
<span class="sd">            like `&quot;field&quot;`, `&quot;check_type&quot;`, `&quot;value&quot;`, `&quot;threshold&quot;`, and `&quot;execute&quot;`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If `source` does not match any supported format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;bigquery&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;project_id&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset_id&quot;</span><span class="p">,</span> <span class="s2">&quot;table_id&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BigQuery source requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">get_config_from_bigquery</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;s3://&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_config_from_s3</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.csv$&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_config_from_csv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;mysql&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MySQL source requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">get_config_from_mysql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;host&quot;</span><span class="p">,</span>
                <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                <span class="s2">&quot;password&quot;</span><span class="p">,</span>
                <span class="s2">&quot;database&quot;</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PostgreSQL source requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">get_config_from_postgresql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;glue&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;glue_context&quot;</span><span class="p">,</span> <span class="s2">&quot;database_name&quot;</span><span class="p">,</span> <span class="s2">&quot;table_name&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Glue source requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_config_from_glue_data_catalog</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;duckdb://&quot;</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_config_from_duckdb</span><span class="p">(</span>
                <span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span>
                <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spark&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Databricks source requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">get_config_from_databricks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknow source: </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_config</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the schema configuration based on the provided data source.</p>
<p>This function reads from a schema_registry table/file to get the expected
schema for a given table. Supports various data sources such as BigQuery,
S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB, and Databricks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the data source. Supported formats:
- <code>bigquery</code>: BigQuery source
- <code>s3://&lt;bucket&gt;/&lt;path&gt;</code>: S3 CSV file
- <code>&lt;file&gt;.csv</code>: Local CSV file
- <code>mysql</code>: MySQL database
- <code>postgresql</code>: PostgreSQL database
- <code>glue</code>: AWS Glue Data Catalog
- <code>duckdb</code>: DuckDB database
- <code>databricks</code>: Databricks Unity Catalog</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source-specific parameters. Common ones:
- table (str): Table name to look up (REQUIRED for all sources)
- environment (str): Environment filter (default: 'prod')
- query (str): Additional WHERE filters (optional)</p>
<p>For BigQuery: project_id, dataset_id, table_id
For MySQL/PostgreSQL: host, user, password, database OR conn
For Glue: glue_context, database_name, table_name
For DuckDB: conn, table
For Databricks: spark, catalog, schema, table
For CSV/S3: file_path/s3_path, table</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: Schema configuration from schema_registry</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If source format is invalid or required params are missing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;bigquery&quot;</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="s2">&quot;proj&quot;</span><span class="p">,</span> <span class="n">dataset_id</span><span class="o">=</span><span class="s2">&quot;ds&quot;</span><span class="p">,</span> <span class="n">table_id</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="n">my_conn</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;s3://bucket/registry.csv&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;prod&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_config</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the schema configuration based on the provided data source.</span>

<span class="sd">    This function reads from a schema_registry table/file to get the expected</span>
<span class="sd">    schema for a given table. Supports various data sources such as BigQuery,</span>
<span class="sd">    S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB, and Databricks.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str):</span>
<span class="sd">            A string representing the data source. Supported formats:</span>
<span class="sd">            - `bigquery`: BigQuery source</span>
<span class="sd">            - `s3://&lt;bucket&gt;/&lt;path&gt;`: S3 CSV file</span>
<span class="sd">            - `&lt;file&gt;.csv`: Local CSV file</span>
<span class="sd">            - `mysql`: MySQL database</span>
<span class="sd">            - `postgresql`: PostgreSQL database</span>
<span class="sd">            - `glue`: AWS Glue Data Catalog</span>
<span class="sd">            - `duckdb`: DuckDB database</span>
<span class="sd">            - `databricks`: Databricks Unity Catalog</span>

<span class="sd">        **kwargs: Source-specific parameters. Common ones:</span>
<span class="sd">            - table (str): Table name to look up (REQUIRED for all sources)</span>
<span class="sd">            - environment (str): Environment filter (default: &#39;prod&#39;)</span>
<span class="sd">            - query (str): Additional WHERE filters (optional)</span>

<span class="sd">            For BigQuery: project_id, dataset_id, table_id</span>
<span class="sd">            For MySQL/PostgreSQL: host, user, password, database OR conn</span>
<span class="sd">            For Glue: glue_context, database_name, table_name</span>
<span class="sd">            For DuckDB: conn, table</span>
<span class="sd">            For Databricks: spark, catalog, schema, table</span>
<span class="sd">            For CSV/S3: file_path/s3_path, table</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: Schema configuration from schema_registry</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If source format is invalid or required params are missing</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;bigquery&quot;, project_id=&quot;proj&quot;, dataset_id=&quot;ds&quot;, table_id=&quot;users&quot;)</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;mysql&quot;, conn=my_conn, table=&quot;users&quot;)</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;s3://bucket/registry.csv&quot;, table=&quot;users&quot;, environment=&quot;prod&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;bigquery&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;project_id&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset_id&quot;</span><span class="p">,</span> <span class="s2">&quot;table_id&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BigQuery schema requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_bigquery</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;s3://&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;table&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;S3 schema requires &#39;table&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_s3</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.csv$&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;table&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CSV schema requires &#39;table&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_csv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;mysql&quot;</span><span class="p">:</span>
            <span class="c1"># Aceita conn OU (host, user, password, database)</span>
            <span class="k">if</span> <span class="s2">&quot;conn&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;MySQL schema requires &#39;conn&#39; OR all of </span><span class="si">{</span><span class="n">required_params</span><span class="si">}</span><span class="s2"> in kwargs&quot;</span>
                        <span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;table&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MySQL schema requires &#39;table&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_mysql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">:</span>
            <span class="c1"># Aceita conn OU (host, user, password, database)</span>
            <span class="k">if</span> <span class="s2">&quot;conn&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;PostgreSQL schema requires &#39;conn&#39; OR all of </span><span class="si">{</span><span class="n">required_params</span><span class="si">}</span><span class="s2"> in kwargs&quot;</span>
                        <span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;table&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PostgreSQL schema requires &#39;table&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_postgresql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;glue&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;glue_context&quot;</span><span class="p">,</span> <span class="s2">&quot;database_name&quot;</span><span class="p">,</span> <span class="s2">&quot;table_name&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Glue schema requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_glue</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;duckdb&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;conn&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DuckDB schema requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_duckdb</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
            <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spark&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Databricks schema requires &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; in kwargs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_databricks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown source: </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_bigquery" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_bigquery</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">table_id</span><span class="p">,</span> <span class="n">credentials_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_bigquery" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from BigQuery schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>project_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery project ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery dataset ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to service account credentials file</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_bigquery</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments,too-many-locals</span>
    <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from BigQuery schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id: BigQuery project ID</span>
<span class="sd">        dataset_id: BigQuery dataset ID</span>
<span class="sd">        table_id: Table name to look up in the registry</span>
<span class="sd">        credentials_path: Path to service account credentials file</span>
<span class="sd">        registry_table: Name of the schema registry table</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">bigquery</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.oauth2</span><span class="w"> </span><span class="kn">import</span> <span class="n">service_account</span>

    <span class="k">if</span> <span class="n">credentials_path</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
            <span class="n">credentials_path</span>
        <span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>

    <span class="n">where_clause</span> <span class="o">=</span> <span class="s2">&quot;table_name = @table_name&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">query</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT </span>
<span class="s2">                id,</span>
<span class="s2">                environment,</span>
<span class="s2">                source_type,</span>
<span class="s2">                database_name,</span>
<span class="s2">                catalog_name,</span>
<span class="s2">                schema_name,</span>
<span class="s2">                table_name,</span>
<span class="s2">                field,</span>
<span class="s2">                data_type,</span>
<span class="s2">                nullable,</span>
<span class="s2">                max_length,</span>
<span class="s2">                comment,</span>
<span class="s2">                created_at,</span>
<span class="s2">                updated_at</span>
<span class="s2">            FROM `</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2">`</span>
<span class="s2">            WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">            ORDER BY id</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="n">job_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span>
        <span class="n">query_parameters</span><span class="o">=</span><span class="p">[</span>
            <span class="n">bigquery</span><span class="o">.</span><span class="n">ScalarQueryParameter</span><span class="p">(</span><span class="s2">&quot;table_name&quot;</span><span class="p">,</span> <span class="s2">&quot;STRING&quot;</span><span class="p">,</span> <span class="n">table_id</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">job_config</span><span class="o">=</span><span class="n">job_config</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span>
            <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">source_type</span><span class="p">,</span>
            <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">database_name</span><span class="p">,</span>
            <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">catalog_name</span><span class="p">,</span>
            <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">schema_name</span><span class="p">,</span>
            <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">field</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">max_length</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">comment</span><span class="p">,</span>
            <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">created_at</span><span class="p">,</span>
            <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">updated_at</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">schema</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> for table &#39;</span><span class="si">{</span><span class="n">table_id</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_csv" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_csv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from CSV schema_registry file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the schema_registry CSV file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CSV delimiter (default: ',')</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters (NOT SUPPORTED for CSV)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_csv</span><span class="p">(</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from CSV schema_registry file</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path: Path to the schema_registry CSV file</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        delimiter: CSV delimiter (default: &#39;,&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters (NOT SUPPORTED for CSV)</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;table_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">table</span><span class="p">:</span>
                <span class="n">schema</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_type&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;database_name&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;catalog_name&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;schema_name&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;table_name&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;field&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_type&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nullable&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                        <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_length&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="k">else</span> <span class="kc">None</span>
                        <span class="p">),</span>
                        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;comment&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;updated_at&quot;</span><span class="p">),</span>
                    <span class="p">}</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">schema</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="sa">f</span><span class="s2">&quot;for table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;query&#39; parameter is not supported for CSV sources and will be ignored&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_databricks" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_databricks</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_databricks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from Databricks Unity Catalog schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SparkSession instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unity Catalog name containing the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name containing the registry table</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table (default: 'schema_registry')</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_databricks</span><span class="p">(</span>
    <span class="n">spark</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from Databricks Unity Catalog schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        spark: SparkSession instance</span>
<span class="sd">        catalog: Unity Catalog name containing the registry</span>
<span class="sd">        schema: Schema name containing the registry table</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        registry_table: Name of the schema registry table (default: &#39;schema_registry&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_escaped</span> <span class="o">=</span> <span class="n">__escape_sql_string</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="n">base_where</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;table_name = &#39;</span><span class="si">{</span><span class="n">table_escaped</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_where</span><span class="si">}</span><span class="s2"> AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="n">base_where</span>

    <span class="n">registry_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            id,</span>
<span class="s2">            environment,</span>
<span class="s2">            source_type,</span>
<span class="s2">            database_name,</span>
<span class="s2">            catalog_name,</span>
<span class="s2">            schema_name,</span>
<span class="s2">            table_name,</span>
<span class="s2">            field,</span>
<span class="s2">            data_type,</span>
<span class="s2">            nullable,</span>
<span class="s2">            max_length,</span>
<span class="s2">            comment,</span>
<span class="s2">            created_at,</span>
<span class="s2">            updated_at</span>
<span class="s2">        FROM </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span>
<span class="s2">        WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">        ORDER BY id</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="p">)</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="n">registry_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span>
                <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">source_type</span><span class="p">,</span>
                <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">database_name</span><span class="p">,</span>
                <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">catalog_name</span><span class="p">,</span>
                <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">schema_name</span><span class="p">,</span>
                <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">field</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span>
                <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">max_length</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">comment</span><span class="p">,</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">created_at</span><span class="p">,</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">updated_at</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_duckdb" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_duckdb</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_duckdb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from DuckDB schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table (default: 'schema_registry')</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_duckdb</span><span class="p">(</span>
    <span class="n">conn</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from DuckDB schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        conn: DuckDB connection object</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        registry_table: Name of the schema registry table (default: &#39;schema_registry&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_escaped</span> <span class="o">=</span> <span class="n">__escape_sql_string</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="n">base_where</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;table_name = &#39;</span><span class="si">{</span><span class="n">table_escaped</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_where</span><span class="si">}</span><span class="s2"> AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="n">base_where</span>

    <span class="c1"># Query no schema_registry</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            id,</span>
<span class="s2">            environment,</span>
<span class="s2">            source_type,</span>
<span class="s2">            database_name,</span>
<span class="s2">            catalog_name,</span>
<span class="s2">            schema_name,</span>
<span class="s2">            table_name,</span>
<span class="s2">            field,</span>
<span class="s2">            data_type,</span>
<span class="s2">            nullable,</span>
<span class="s2">            max_length,</span>
<span class="s2">            comment,</span>
<span class="s2">            created_at,</span>
<span class="s2">            updated_at</span>
<span class="s2">        FROM </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span>
<span class="s2">        WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">        ORDER BY id</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="sa">f</span><span class="s2">&quot;for table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">schema</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">],</span>
                <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;source_type&quot;</span><span class="p">],</span>
                <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;database_name&quot;</span><span class="p">],</span>
                <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;catalog_name&quot;</span><span class="p">],</span>
                <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;schema_name&quot;</span><span class="p">],</span>
                <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;table_name&quot;</span><span class="p">],</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">],</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_type&quot;</span><span class="p">],</span>
                <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;nullable&quot;</span><span class="p">],</span>
                <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">],</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">],</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;created_at&quot;</span><span class="p">],</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;updated_at&quot;</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_glue" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_glue</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_glue" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from Glue Data Catalog schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>glue_context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GlueContext instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Glue database containing the registry table</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table (default: 'schema_registry')</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_glue</span><span class="p">(</span>
    <span class="n">glue_context</span><span class="p">,</span>
    <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from Glue Data Catalog schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        glue_context: GlueContext instance</span>
<span class="sd">        database_name: Glue database containing the registry table</span>
<span class="sd">        table_name: Table name to look up in the registry</span>
<span class="sd">        registry_table: Name of the schema registry table (default: &#39;schema_registry&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">awsglue.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlueContext</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">GlueContext</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Valid GlueContext required&quot;</span><span class="p">)</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">glue_context</span><span class="o">.</span><span class="n">spark_session</span>

    <span class="n">table_name_escaped</span> <span class="o">=</span> <span class="n">__escape_sql_string</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>

    <span class="n">where_clause</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;table_name = &#39;</span><span class="si">{</span><span class="n">table_name_escaped</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">query</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">registry_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            id,</span>
<span class="s2">            environment,</span>
<span class="s2">            source_type,</span>
<span class="s2">            database_name,</span>
<span class="s2">            catalog_name,</span>
<span class="s2">            schema_name,</span>
<span class="s2">            table_name,</span>
<span class="s2">            field,</span>
<span class="s2">            data_type,</span>
<span class="s2">            nullable,</span>
<span class="s2">            max_length,</span>
<span class="s2">            comment,</span>
<span class="s2">            created_at,</span>
<span class="s2">            updated_at</span>
<span class="s2">        FROM </span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span>
<span class="s2">        WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">        ORDER BY id</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="p">)</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="n">registry_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">schema</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span>
                <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">source_type</span><span class="p">,</span>
                <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">database_name</span><span class="p">,</span>
                <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">catalog_name</span><span class="p">,</span>
                <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">schema_name</span><span class="p">,</span>
                <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">field</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span>
                <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">max_length</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">comment</span><span class="p">,</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">created_at</span><span class="p">,</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">updated_at</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_mysql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_mysql</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_mysql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from MySQL schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MySQL host (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MySQL user (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MySQL password (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database containing the registry table (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MySQL port (default: 3306)</p>
              </div>
            </td>
            <td>
                  <code>3306</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table (default: 'schema_registry')</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing MySQL connection (optional, will create new if not provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_mysql</span><span class="p">(</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Novo parâmetro</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from MySQL schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        host: MySQL host (not needed if conn is provided)</span>
<span class="sd">        user: MySQL user (not needed if conn is provided)</span>
<span class="sd">        password: MySQL password (not needed if conn is provided)</span>
<span class="sd">        database: Database containing the registry table (not needed if conn is provided)</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        port: MySQL port (default: 3306)</span>
<span class="sd">        registry_table: Name of the schema registry table (default: &#39;schema_registry&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>
<span class="sd">        conn: Existing MySQL connection (optional, will create new if not provided)</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">mysql.connector</span>

    <span class="k">if</span> <span class="n">conn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Either &#39;conn&#39; or all of (host, user, password, database) must be provided&quot;</span>
            <span class="p">)</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span>
        <span class="p">)</span>
        <span class="n">should_close</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">should_close</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">dictionary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">base_where</span> <span class="o">=</span> <span class="s2">&quot;table_name = </span><span class="si">%s</span><span class="s2">&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_where</span><span class="si">}</span><span class="s2"> AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="n">base_where</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">registry_table</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid registry_table name: </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT </span>
<span class="s2">                id,</span>
<span class="s2">                environment,</span>
<span class="s2">                source_type,</span>
<span class="s2">                database_name,</span>
<span class="s2">                catalog_name,</span>
<span class="s2">                schema_name,</span>
<span class="s2">                table_name,</span>
<span class="s2">                field,</span>
<span class="s2">                data_type,</span>
<span class="s2">                nullable,</span>
<span class="s2">                max_length,</span>
<span class="s2">                comment,</span>
<span class="s2">                created_at,</span>
<span class="s2">                updated_at</span>
<span class="s2">            FROM </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span>
<span class="s2">            WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">            ORDER BY id</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">should_close</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">schema</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> for table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_postgresql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_postgresql</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">registry_table</span><span class="o">=</span><span class="s1">&#39;schema_registry&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_postgresql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from PostgreSQL schema_registry table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PostgreSQL host (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PostgreSQL user (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PostgreSQL password (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database containing the registry table (not needed if conn is provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema containing the registry table</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PostgreSQL port (default: 5432)</p>
              </div>
            </td>
            <td>
                  <code>5432</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>registry_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the schema registry table (default: 'schema_registry')</p>
              </div>
            </td>
            <td>
                  <code>&#39;schema_registry&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing PostgreSQL connection (optional, will create new if not provided)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_postgresql</span><span class="p">(</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5432</span><span class="p">,</span>
    <span class="n">registry_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;schema_registry&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Novo parâmetro</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from PostgreSQL schema_registry table</span>

<span class="sd">    Args:</span>
<span class="sd">        host: PostgreSQL host (not needed if conn is provided)</span>
<span class="sd">        user: PostgreSQL user (not needed if conn is provided)</span>
<span class="sd">        password: PostgreSQL password (not needed if conn is provided)</span>
<span class="sd">        database: Database containing the registry table (not needed if conn is provided)</span>
<span class="sd">        schema: Schema containing the registry table</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        port: PostgreSQL port (default: 5432)</span>
<span class="sd">        registry_table: Name of the schema registry table (default: &#39;schema_registry&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters</span>
<span class="sd">        conn: Existing PostgreSQL connection (optional, will create new if not provided)</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">psycopg2</span>

    <span class="k">if</span> <span class="n">conn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Either &#39;conn&#39; or all of (host, user, password, database) must be provided&quot;</span>
            <span class="p">)</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">dbname</span><span class="o">=</span><span class="n">database</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span>
        <span class="p">)</span>
        <span class="n">should_close</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">should_close</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">base_where</span> <span class="o">=</span> <span class="s2">&quot;table_name = </span><span class="si">%s</span><span class="s2">&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_where</span><span class="si">}</span><span class="s2"> AND (</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="n">base_where</span>

    <span class="n">schema_name</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="s2">&quot;public&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">schema_name</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid schema name: </span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">registry_table</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid registry_table name: </span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT</span>
<span class="s2">                id,</span>
<span class="s2">                environment,</span>
<span class="s2">                source_type,</span>
<span class="s2">                database_name,</span>
<span class="s2">                catalog_name,</span>
<span class="s2">                schema_name,</span>
<span class="s2">                table_name,</span>
<span class="s2">                field,</span>
<span class="s2">                data_type,</span>
<span class="s2">                nullable,</span>
<span class="s2">                max_length,</span>
<span class="s2">                comment,</span>
<span class="s2">                created_at,</span>
<span class="s2">                updated_at</span>
<span class="s2">            FROM </span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span>
<span class="s2">            WHERE </span><span class="si">{</span><span class="n">where_clause</span><span class="si">}</span>
<span class="s2">            ORDER BY id</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">should_close</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">cols</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No schema found in </span><span class="si">{</span><span class="n">database</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">registry_table</span><span class="si">}</span><span class="s2"> for table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;source_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;database_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="s2">&quot;catalog_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span>
            <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cols</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_s3" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_s3" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get schema from S3 schema_registry CSV file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>s3_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 URI to the schema_registry CSV file (e.g., 's3://bucket/path/schema_registry.csv')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name to look up in the registry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CSV delimiter (default: ',')</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom WHERE clause for additional filters (NOT SUPPORTED for S3/CSV)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts with schema information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_s3</span><span class="p">(</span>
    <span class="n">s3_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get schema from S3 schema_registry CSV file</span>

<span class="sd">    Args:</span>
<span class="sd">        s3_path: S3 URI to the schema_registry CSV file (e.g., &#39;s3://bucket/path/schema_registry.csv&#39;)</span>
<span class="sd">        table: Table name to look up in the registry</span>
<span class="sd">        delimiter: CSV delimiter (default: &#39;,&#39;)</span>
<span class="sd">        query: Optional custom WHERE clause for additional filters (NOT SUPPORTED for S3/CSV)</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts with schema information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">__read_s3_file</span><span class="p">(</span><span class="n">s3_path</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="n">temp_path</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_schema_from_csv</span><span class="p">(</span>
            <span class="n">file_path</span><span class="o">=</span><span class="n">temp_path</span><span class="p">,</span>
            <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
            <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">temp_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.report" class="doc doc-heading">
            <code class=" language-python"><span class="n">report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Quality Check&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.report" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs a quality check on the given DataFrame based on the provided rules.</p>
<p>The function iterates over a list of rules and applies different checks to the
specified fields of the DataFrame. The checks include validation of completeness,
uniqueness, specific values, patterns, and other conditions. Each rule corresponds
to a particular type of validation, such as 'is_complete', 'is_greater_than',
'has_mean', etc. After applying the checks, the function returns the result of
the validation.</p>
<p>Parameters:
- df (DataFrame): The DataFrame to be validated.
- rules (list of dict): A list of rules defining the checks to be performed.
    Each rule is a dictionary with the following keys:
    - "check_type": The type of check to apply.
    - "field": The column of the DataFrame to check.
    - "value" (optional): The value used for comparison in some checks (e.g., for 'is_greater_than').
    - "threshold" (optional): A percentage threshold to be applied in some checks.
- name (str): The name of the quality check (default is "Quality Check").</p>
<p>Returns:
- quality_check (CheckResult): The result of the quality validation.</p>
<p>Warnings:
- If an unknown rule name is encountered, a warning is generated.</p>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Quality Check&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a quality check on the given DataFrame based on the provided rules.</span>

<span class="sd">    The function iterates over a list of rules and applies different checks to the</span>
<span class="sd">    specified fields of the DataFrame. The checks include validation of completeness,</span>
<span class="sd">    uniqueness, specific values, patterns, and other conditions. Each rule corresponds</span>
<span class="sd">    to a particular type of validation, such as &#39;is_complete&#39;, &#39;is_greater_than&#39;,</span>
<span class="sd">    &#39;has_mean&#39;, etc. After applying the checks, the function returns the result of</span>
<span class="sd">    the validation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (DataFrame): The DataFrame to be validated.</span>
<span class="sd">    - rules (list of dict): A list of rules defining the checks to be performed.</span>
<span class="sd">        Each rule is a dictionary with the following keys:</span>
<span class="sd">        - &quot;check_type&quot;: The type of check to apply.</span>
<span class="sd">        - &quot;field&quot;: The column of the DataFrame to check.</span>
<span class="sd">        - &quot;value&quot; (optional): The value used for comparison in some checks (e.g., for &#39;is_greater_than&#39;).</span>
<span class="sd">        - &quot;threshold&quot; (optional): A percentage threshold to be applied in some checks.</span>
<span class="sd">    - name (str): The name of the quality check (default is &quot;Quality Check&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - quality_check (CheckResult): The result of the quality validation.</span>

<span class="sd">    Warnings:</span>
<span class="sd">    - If an unknown rule name is encountered, a warning is generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check</span> <span class="o">=</span> <span class="n">Check</span><span class="p">(</span><span class="n">CheckLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;check_type&quot;</span><span class="p">]</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">threshold</span>

        <span class="k">match</span> <span class="n">rule_name</span><span class="p">:</span>

            <span class="k">case</span> <span class="s2">&quot;is_complete&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_unique&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_unique</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_primary_key&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_primary_key</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;are_complete&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;are_unique&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_composite_key&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_greater_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_greater_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_positive&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_positive</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_negative&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_negative</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_greater_or_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_greater_or_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_less_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_less_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_less_or_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_less_or_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_contained_in&quot;</span> <span class="o">|</span> <span class="s2">&quot;is_in&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_contained_in</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;not_contained_in&quot;</span> <span class="o">|</span> <span class="s2">&quot;not_in&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_contained_in</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_between&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_pattern&quot;</span><span class="p">:</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_pattern</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_legit&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_legit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_min&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_min</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_max&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_max</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_std&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_std</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_mean&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_mean</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_sum&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_sum</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_cardinality&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_cardinality</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_infogain&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_infogain</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_entropy&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_entropy</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_in_millions&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_in_millions</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_in_billions&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_in_millions</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_1&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_1</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_2&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_2</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_3&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_3</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_today&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_today</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_yesterday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_yesterday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_weekday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_weekday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_weekend&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_weekend</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_monday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_monday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_tuesday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_tuesday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_wednesday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_wednesday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_thursday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_thursday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_friday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_friday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_saturday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_saturday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_sunday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_sunday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;satisfies&quot;</span><span class="p">:</span>
                <span class="n">predicate</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">satisfies</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown rule name: </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">quality_check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quality_check</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.summarize" class="doc doc-heading">
            <code class=" language-python"><span class="n">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#sumeh.core.summarize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Summarizes a DataFrame based on the provided rules and context.</p>
<p>This function dynamically detects the appropriate engine to use for summarization
based on the type of the input DataFrame. It delegates the summarization process
to the corresponding engine module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input DataFrame to be summarized. The type of the DataFrame determines
the engine used for summarization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries defining the summarization rules.
Each dictionary specifies the operations or transformations to be applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context parameters required by specific engines. Common
parameters include:
- conn: A database connection object (used by certain engines like DuckDB).
- total_rows: The total number of rows in the DataFrame (optional).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The summarized DataFrame as processed by the appropriate engine.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the type of the input DataFrame is unsupported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function uses the <code>__detect_engine</code> method to determine the engine name
  based on the input DataFrame.</li>
<li>Supported engines are dynamically imported from the <code>sumeh.engine</code> package.</li>
<li>The "duckdb_engine" case requires a database connection (<code>conn</code>) to be passed
  in the context.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>summarized_df = summarize(df, rules=[{"operation": "sum", "column": "sales"}], conn=my_conn)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summarizes a DataFrame based on the provided rules and context.</span>

<span class="sd">    This function dynamically detects the appropriate engine to use for summarization</span>
<span class="sd">    based on the type of the input DataFrame. It delegates the summarization process</span>
<span class="sd">    to the corresponding engine module.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: The input DataFrame to be summarized. The type of the DataFrame determines</span>
<span class="sd">            the engine used for summarization.</span>
<span class="sd">        rules (list[dict]): A list of dictionaries defining the summarization rules.</span>
<span class="sd">            Each dictionary specifies the operations or transformations to be applied.</span>
<span class="sd">        **context: Additional context parameters required by specific engines. Common</span>
<span class="sd">            parameters include:</span>
<span class="sd">            - conn: A database connection object (used by certain engines like DuckDB).</span>
<span class="sd">            - total_rows: The total number of rows in the DataFrame (optional).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The summarized DataFrame as processed by the appropriate engine.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the type of the input DataFrame is unsupported.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function uses the `__detect_engine` method to determine the engine name</span>
<span class="sd">          based on the input DataFrame.</span>
<span class="sd">        - Supported engines are dynamically imported from the `sumeh.engine` package.</span>
<span class="sd">        - The &quot;duckdb_engine&quot; case requires a database connection (`conn`) to be passed</span>
<span class="sd">          in the context.</span>

<span class="sd">    Example:</span>
<span class="sd">        summarized_df = summarize(df, rules=[{&quot;operation&quot;: &quot;sum&quot;, &quot;column&quot;: &quot;sales&quot;}], conn=my_conn)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">match</span> <span class="n">engine_name</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;duckdb_engine&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span>
                <span class="n">df_rel</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">rules</span><span class="o">=</span><span class="n">rules</span><span class="p">,</span>
                <span class="n">conn</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">),</span>
                <span class="n">total_rows</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_rows&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">total_rows</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_rows&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.validate" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#sumeh.core.validate" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates a DataFrame against a set of rules using the appropriate engine.</p>
<p>This function dynamically detects the engine to use based on the input
DataFrame and delegates the validation process to the corresponding engine's
implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input DataFrame to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span> or <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validation rules to be applied to the DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context parameters that may be required by the engine.
- conn (optional): A database connection object, required for certain engines
  like "duckdb_engine".</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool or dict: The result of the validation process. The return type and structure</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>depend on the specific engine's implementation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the required engine module cannot be imported.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the detected engine does not have a <code>validate</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The engine is dynamically determined based on the DataFrame type or other
  characteristics.</li>
<li>For "duckdb_engine", a database connection object should be provided in the
  context under the key "conn".</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a DataFrame against a set of rules using the appropriate engine.</span>

<span class="sd">    This function dynamically detects the engine to use based on the input</span>
<span class="sd">    DataFrame and delegates the validation process to the corresponding engine&#39;s</span>
<span class="sd">    implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The input DataFrame to be validated.</span>
<span class="sd">        rules (list or dict): The validation rules to be applied to the DataFrame.</span>
<span class="sd">        **context: Additional context parameters that may be required by the engine.</span>
<span class="sd">            - conn (optional): A database connection object, required for certain engines</span>
<span class="sd">              like &quot;duckdb_engine&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool or dict: The result of the validation process. The return type and structure</span>
<span class="sd">        depend on the specific engine&#39;s implementation.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the required engine module cannot be imported.</span>
<span class="sd">        AttributeError: If the detected engine does not have a `validate` method.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The engine is dynamically determined based on the DataFrame type or other</span>
<span class="sd">          characteristics.</span>
<span class="sd">        - For &quot;duckdb_engine&quot;, a database connection object should be provided in the</span>
<span class="sd">          context under the key &quot;conn&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">match</span> <span class="n">engine_name</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;duckdb_engine&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">))</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.validate_schema" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate_schema</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.validate_schema" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates the schema of a given data source or connection against an expected schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_or_conn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data source or connection to validate. This can be a DataFrame,
              database connection, or other supported data structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries defining the expected schema.
                             Each dictionary should describe a column or field,
                             including its name, type, and other attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>engine</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the engine to use for validation. This determines the
          specific validation logic to apply based on the data source type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**engine_kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the engine's validation logic.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating
                                whether the schema is valid, and the second element is
                                a list of tuples containing error messages for any
                                validation failures. Each tuple consists of the field
                                name and the corresponding error message.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_schema</span><span class="p">(</span>
    <span class="n">df_or_conn</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the schema of a given data source or connection against an expected schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_or_conn (Any): The data source or connection to validate. This can be a DataFrame,</span>
<span class="sd">                          database connection, or other supported data structure.</span>
<span class="sd">        expected (List[Dict[str, Any]]): A list of dictionaries defining the expected schema.</span>
<span class="sd">                                         Each dictionary should describe a column or field,</span>
<span class="sd">                                         including its name, type, and other attributes.</span>
<span class="sd">        engine (str): The name of the engine to use for validation. This determines the</span>
<span class="sd">                      specific validation logic to apply based on the data source type.</span>
<span class="sd">        **engine_kwargs: Additional keyword arguments to pass to the engine&#39;s validation logic.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating</span>
<span class="sd">                                            whether the schema is valid, and the second element is</span>
<span class="sd">                                            a list of tuples containing error messages for any</span>
<span class="sd">                                            validation failures. Each tuple consists of the field</span>
<span class="sd">                                            name and the corresponding error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate_schema</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="n">expected</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>