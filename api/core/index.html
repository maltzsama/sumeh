
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Library for Data Quality checks">
      
      
        <meta name="author" content="Demetrius Albuquerque">
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../cli/">
      
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Core - Sumeh DQ — Unified Data Quality Framework</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-sumehcore" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-header__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../img/sumeh.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sumeh DQ — Unified Data Quality Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-nav__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../img/sumeh.svg" alt="logo">

    </a>
    Sumeh DQ — Unified Data Quality Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.core._CONFIG_DISPATCH" class="md-nav__link">
    <span class="md-ellipsis">
      _CONFIG_DISPATCH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__detect_engine" class="md-nav__link">
    <span class="md-ellipsis">
      __detect_engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__parse_databricks_uri" class="md-nav__link">
    <span class="md-ellipsis">
      __parse_databricks_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_glue_data_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_glue_data_catalog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_rules_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_rules_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_glue" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_glue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services-config.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services.Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services-utils.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services.Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engine overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-dask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dask engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-duckdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DuckDB engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Polars engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/engine-pyspark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pyspark engine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tests
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.core._CONFIG_DISPATCH" class="md-nav__link">
    <span class="md-ellipsis">
      _CONFIG_DISPATCH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__detect_engine" class="md-nav__link">
    <span class="md-ellipsis">
      __detect_engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.__parse_databricks_uri" class="md-nav__link">
    <span class="md-ellipsis">
      __parse_databricks_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_glue_data_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_glue_data_catalog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_config_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_rules_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_rules_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_bigquery" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_bigquery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_csv" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_duckdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_glue" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_glue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_mysql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_mysql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_postgresql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.get_schema_from_s3" class="md-nav__link">
    <span class="md-ellipsis">
      get_schema_from_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.core.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="module-sumehcore">Module <code>sumeh.core</code><a class="headerlink" href="#module-sumehcore" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>This module provides a set of functions and utilities for data validation, schema 
retrieval, and summarization. It supports multiple data sources and engines, 
including BigQuery, S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB, and Databricks.</p>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_rules_config(source, **kwargs) (sumeh.core.get_rules_config)" href="#sumeh.core.get_rules_config">get_rules_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, **kwargs) -&gt; List[Dict[str, Any]]:
Retrieves configuration rules based on the specified source.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_schema_config(source, **kwargs) (sumeh.core.get_schema_config)" href="#sumeh.core.get_schema_config">get_schema_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, **kwargs) -&gt; List[Dict[str, Any]]:
Retrieves the schema configuration based on the provided data source.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__detect_engine(df) (sumeh.core.__detect_engine)" href="#sumeh.core.__detect_engine">__detect_engine</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate_schema(df_or_conn, expected, engine, **engine_kwargs) (sumeh.core.validate_schema)" href="#sumeh.core.validate_schema">validate_schema</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Any, expected: List[Dict[str, Any]], engine: str, **engine_kwargs) -&gt; Tuple[bool, List[Tuple[str, str]]]:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate(df, rules, **context) (sumeh.core.validate)" href="#sumeh.core.validate">validate</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="summarize(df, rules, **context) (sumeh.core.summarize)" href="#sumeh.core.summarize">summarize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>list[dict], **context):</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="report(df, rules, name='Quality Check') (sumeh.core.report)" href="#sumeh.core.report">report</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>list[dict], name: str = "Quality Check"):</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="constants" open>
  <summary>Constants</summary>
  <p>_CONFIG_DISPATCH: A dictionary mapping data source types (e.g., "mysql", "postgresql") 
  to their respective configuration retrieval functions.</p>
</details>

<details class="imports" open>
  <summary>Imports</summary>
  <p>cuallee: Provides the <code>Check</code> and <code>CheckLevel</code> classes for data validation.
warnings: Used to issue warnings for unknown rule names.
importlib: Dynamically imports modules based on engine detection.
typing: Provides type hints for function arguments and return values.
re: Used for regular expression matching in source string parsing.
sumeh.services.config: Contains functions for retrieving configurations and schemas 
  from various data sources.
sumeh.services.utils: Provides utility functions for value conversion and URI parsing.</p>
<p>The module uses Python's structural pattern matching (<code>match-case</code>) to handle 
different data source types and validation rules.
The <code>report</code> function supports a wide range of validation checks, including 
completeness, uniqueness, value comparisons, patterns, and date-related checks.
The <code>validate</code> and <code>summarize</code> functions dynamically detect the appropriate engine 
based on the input DataFrame type and delegate the processing to the corresponding 
engine module.</p>
</details>








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="sumeh.core._CONFIG_DISPATCH" class="doc doc-heading">
            <code class=" language-python"><span class="n">_CONFIG_DISPATCH</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mysql&#39;</span><span class="p">:</span> <span class="n">get_config_from_mysql</span><span class="p">,</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">:</span> <span class="n">get_config_from_postgresql</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sumeh.core._CONFIG_DISPATCH" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h2 id="sumeh.core.__convert_value" class="doc doc-heading">
            <code class=" language-python"><span class="n">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#sumeh.core.__convert_value" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts the provided value to the appropriate type (date, float, or int).</p>
<p>Depending on the format of the input value, it will be converted to a datetime object,
a floating-point number (float), or an integer (int).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be converted, represented as a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the value does not match an expected format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the provided value to the appropriate type (date, float, or int).</span>

<span class="sd">    Depending on the format of the input value, it will be converted to a datetime object,</span>
<span class="sd">    a floating-point number (float), or an integer (int).</span>

<span class="sd">    Args:</span>
<span class="sd">        value (str): The value to be converted, represented as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the value does not match an expected format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.__detect_engine" class="doc doc-heading">
            <code class=" language-python"><span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

<a href="#sumeh.core.__detect_engine" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Detects the engine type of the given DataFrame based on its module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame object whose engine type is to be detected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the detected engine type. Possible values are:
- "pyspark_engine" for PySpark DataFrames
- "dask_engine" for Dask DataFrames
- "polars_engine" for Polars DataFrames
- "pandas_engine" for Pandas DataFrames
- "duckdb_engine" for DuckDB or BigQuery DataFrames</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the DataFrame type is unsupported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detects the engine type of the given DataFrame based on its module.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: The DataFrame object whose engine type is to be detected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representing the detected engine type. Possible values are:</span>
<span class="sd">            - &quot;pyspark_engine&quot; for PySpark DataFrames</span>
<span class="sd">            - &quot;dask_engine&quot; for Dask DataFrames</span>
<span class="sd">            - &quot;polars_engine&quot; for Polars DataFrames</span>
<span class="sd">            - &quot;pandas_engine&quot; for Pandas DataFrames</span>
<span class="sd">            - &quot;duckdb_engine&quot; for DuckDB or BigQuery DataFrames</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the DataFrame type is unsupported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span>
    <span class="k">match</span> <span class="n">mod</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pyspark&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;pyspark_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dask&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;dask_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;polars&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;polars_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pandas&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;pandas_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;duckdb&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;duckdb_engine&quot;</span>
        <span class="k">case</span> <span class="n">m</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bigquery&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;duckdb_engine&quot;</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported DataFrame type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.__parse_databricks_uri" class="doc doc-heading">
            <code class=" language-python"><span class="n">__parse_databricks_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

<a href="#sumeh.core.__parse_databricks_uri" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Parses a Databricks URI into its catalog, schema, and table components.</p>
<p>The URI is expected to follow the format <code>protocol://catalog.schema.table</code> or 
<code>protocol://schema.table</code>. If the catalog is not provided, it will be set to <code>None</code>. 
If the schema is not provided, the current database from the active Spark session 
will be used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uri</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Databricks URI to parse.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Optional">Optional</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, Optional[str]]: A dictionary containing the parsed components:
- "catalog" (Optional[str]): The catalog name, or <code>None</code> if not provided.
- "schema" (Optional[str]): The schema name, or the current database if not provided.
- "table" (Optional[str]): The table name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__parse_databricks_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses a Databricks URI into its catalog, schema, and table components.</span>

<span class="sd">    The URI is expected to follow the format `protocol://catalog.schema.table` or </span>
<span class="sd">    `protocol://schema.table`. If the catalog is not provided, it will be set to `None`. </span>
<span class="sd">    If the schema is not provided, the current database from the active Spark session </span>
<span class="sd">    will be used.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): The Databricks URI to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Optional[str]]: A dictionary containing the parsed components:</span>
<span class="sd">            - &quot;catalog&quot; (Optional[str]): The catalog name, or `None` if not provided.</span>
<span class="sd">            - &quot;schema&quot; (Optional[str]): The schema name, or the current database if not provided.</span>
<span class="sd">            - &quot;table&quot; (Optional[str]): The table name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">parts</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

        <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">currentDatabase</span><span class="p">()</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="n">catalog</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_bigquery" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_bigquery</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">table_id</span><span class="p">,</span> <span class="n">credentials_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_bigquery" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a Google BigQuery table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>project_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Google Cloud project ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery dataset ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery table ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to service account credentials file (if not provided, defaults to default credentials).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if not provided, defaults to SELECT *).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error while querying BigQuery.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_bigquery</span><span class="p">(</span>
    <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a Google BigQuery table.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): Google Cloud project ID.</span>
<span class="sd">        dataset_id (str): BigQuery dataset ID.</span>
<span class="sd">        table_id (str): BigQuery table ID.</span>
<span class="sd">        credentials_path (Optional[str]): Path to service account credentials file (if not provided, defaults to default credentials).</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, defaults to SELECT *).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error while querying BigQuery.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">bigquery</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.auth.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">DefaultCredentialsError</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table_id</span><span class="si">}</span><span class="s2">`&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="p">(</span>
                <span class="kc">None</span>
                <span class="k">if</span> <span class="n">credentials_path</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span><span class="n">credentials_path</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Execute the query and convert the result to a pandas DataFrame</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>

        <span class="c1"># Convert the DataFrame to a list of dictionaries</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>

        <span class="c1"># Parse the data and return the result</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">DefaultCredentialsError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Credentials error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error occurred while querying BigQuery: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_csv" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_csv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a CSV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local file path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The delimiter used in the CSV file (default is ",").</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error reading or processing the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_csv</span><span class="p">(</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The local file path to the CSV file.</span>
<span class="sd">        delimiter (Optional[str]): The delimiter used in the CSV file (default is &quot;,&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error reading or processing the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">__read_local_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">__read_csv_file</span><span class="p">(</span><span class="n">file_content</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39; not found. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error while parsing CSV file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Catch any unexpected exceptions</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected error while processing CSV file &#39;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&#39;. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_databricks" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_databricks</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_databricks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_databricks</span><span class="p">(</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">catalog</span> <span class="ow">and</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">table</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_duckdb" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_duckdb</span><span class="p">(</span><span class="n">db_path</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_duckdb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve configuration data from a DuckDB database.</p>
<p>This function fetches data from a DuckDB database either by executing a custom SQL query
or by selecting all rows from a specified table. The data is then parsed into a list of
dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>db_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the DuckDB database file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table to fetch data from. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A custom SQL query to execute. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A valid DuckDB connection object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the fetched data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>table</code> nor <code>query</code> is provided, or if a valid <code>conn</code> is not supplied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import duckdb
conn = duckdb.connect('my_db.duckdb')
config = get_config_from_duckdb('my_db.duckdb', table='rules', conn=conn)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_duckdb</span><span class="p">(</span><span class="n">db_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve configuration data from a DuckDB database.</span>

<span class="sd">    This function fetches data from a DuckDB database either by executing a custom SQL query</span>
<span class="sd">    or by selecting all rows from a specified table. The data is then parsed into a list of</span>
<span class="sd">    dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        db_path (str): The path to the DuckDB database file.</span>
<span class="sd">        table (str, optional): The name of the table to fetch data from. Defaults to None.</span>
<span class="sd">        query (str, optional): A custom SQL query to execute. Defaults to None.</span>
<span class="sd">        conn: A valid DuckDB connection object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the fetched data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `table` nor `query` is provided, or if a valid `conn` is not supplied.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import duckdb</span>
<span class="sd">        &gt;&gt;&gt; conn = duckdb.connect(&#39;my_db.duckdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; config = get_config_from_duckdb(&#39;my_db.duckdb&#39;, table=&#39;rules&#39;, conn=conn)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">table</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;DuckDB configuration requires:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;1. Either a `table` name or custom `query`</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;2. A valid database `conn` connection object</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Example: get_config(&#39;duckdb&#39;, table=&#39;rules&#39;, conn=duckdb.connect(&#39;my_db.duckdb&#39;))&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_glue_data_catalog" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_glue_data_catalog</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_glue_data_catalog" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from AWS Glue Data Catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>glue_context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <code>GlueContext</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Glue database name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Glue table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if provided).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error querying Glue Data Catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_glue_data_catalog</span><span class="p">(</span>
    <span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from AWS Glue Data Catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        glue_context: An instance of `GlueContext`.</span>
<span class="sd">        database_name (str): Glue database name.</span>
<span class="sd">        table_name (str): Glue table name.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if provided).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error querying Glue Data Catalog.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">awsglue.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlueContext</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">GlueContext</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided context is not a valid GlueContext.&quot;</span><span class="p">)</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">glue_context</span><span class="o">.</span><span class="n">spark_session</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dynamic_frame</span> <span class="o">=</span> <span class="n">glue_context</span><span class="o">.</span><span class="n">create_dynamic_frame</span><span class="o">.</span><span class="n">from_catalog</span><span class="p">(</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database_name</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span>
        <span class="p">)</span>

        <span class="n">data_frame</span> <span class="o">=</span> <span class="n">dynamic_frame</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
            <span class="n">data_frame</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;table_name&quot;</span><span class="p">)</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">collect</span><span class="p">()]</span>

        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error occurred while querying Glue Data Catalog: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_mysql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_mysql</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_mysql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a MySQL database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>connection</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An existing MySQL connection object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Host of the MySQL server.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Username to connect to MySQL.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for the MySQL user.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database name to query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The port for the MySQL connection (default is 3306).</p>
              </div>
            </td>
            <td>
                  <code>3306</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if not provided, <code>schema</code> and <code>table</code> must be given).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>query</code> nor both <code>schema</code> and <code>table</code> are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ConnectionError">ConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error connecting to MySQL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error executing the query or processing the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_mysql</span><span class="p">(</span>
    <span class="n">connection</span><span class="p">:</span> <span class="n">Optional</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a MySQL database.</span>

<span class="sd">    Args:</span>
<span class="sd">        connection (Optional): An existing MySQL connection object.</span>
<span class="sd">        host (Optional[str]): Host of the MySQL server.</span>
<span class="sd">        user (Optional[str]): Username to connect to MySQL.</span>
<span class="sd">        password (Optional[str]): Password for the MySQL user.</span>
<span class="sd">        database (Optional[str]): Database name to query.</span>
<span class="sd">        port (Optional[int]): The port for the MySQL connection (default is 3306).</span>
<span class="sd">        schema (Optional[str]): Schema name if query is not provided.</span>
<span class="sd">        table (Optional[str]): Table name if query is not provided.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, `schema` and `table` must be given).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `query` nor both `schema` and `table` are provided.</span>
<span class="sd">        ConnectionError: If there is an error connecting to MySQL.</span>
<span class="sd">        RuntimeError: If there is an error executing the query or processing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">mysql.connector</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;You must provide either a &#39;query&#39; or both &#39;schema&#39; and &#39;table&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="ow">or</span> <span class="n">__create_connection</span><span class="p">(</span>
            <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">port</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error connecting to MySQL database: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error executing the query or processing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connection</span> <span class="ow">and</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_postgresql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_postgresql</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_postgresql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a PostgreSQL database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>connection</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An existing PostgreSQL connection object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Host of the PostgreSQL server.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Username to connect to PostgreSQL.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for the PostgreSQL user.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database name to query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The port for the PostgreSQL connection (default is 5432).</p>
              </div>
            </td>
            <td>
                  <code>5432</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name if query is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom SQL query to fetch data (if not provided, <code>schema</code> and <code>table</code> must be given).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither <code>query</code> nor both <code>schema</code> and <code>table</code> are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ConnectionError">ConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error connecting to PostgreSQL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error executing the query or processing the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_postgresql</span><span class="p">(</span>
    <span class="n">connection</span><span class="p">:</span> <span class="n">Optional</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5432</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a PostgreSQL database.</span>

<span class="sd">    Args:</span>
<span class="sd">        connection (Optional): An existing PostgreSQL connection object.</span>
<span class="sd">        host (Optional[str]): Host of the PostgreSQL server.</span>
<span class="sd">        user (Optional[str]): Username to connect to PostgreSQL.</span>
<span class="sd">        password (Optional[str]): Password for the PostgreSQL user.</span>
<span class="sd">        database (Optional[str]): Database name to query.</span>
<span class="sd">        port (Optional[int]): The port for the PostgreSQL connection (default is 5432).</span>
<span class="sd">        schema (Optional[str]): Schema name if query is not provided.</span>
<span class="sd">        table (Optional[str]): Table name if query is not provided.</span>
<span class="sd">        query (Optional[str]): Custom SQL query to fetch data (if not provided, `schema` and `table` must be given).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither `query` nor both `schema` and `table` are provided.</span>
<span class="sd">        ConnectionError: If there is an error connecting to PostgreSQL.</span>
<span class="sd">        RuntimeError: If there is an error executing the query or processing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">psycopg2</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;You must provide either a &#39;query&#39; or both &#39;schema&#39; and &#39;table&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span> <span class="ow">or</span> <span class="n">__create_connection</span><span class="p">(</span>
            <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">port</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error connecting to PostgreSQL database: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error executing the query or processing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connection</span> <span class="ow">and</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_config_from_s3" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_config_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.get_config_from_s3" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieves configuration data from a CSV file stored in an S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>s3_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The delimiter used in the CSV file (default is ",").</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error reading or processing the S3 file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves configuration data from a CSV file stored in an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        s3_path (str): The S3 path to the CSV file.</span>
<span class="sd">        delimiter (Optional[str]): The delimiter used in the CSV file (default is &quot;,&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the parsed configuration data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If there is an error reading or processing the S3 file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">__read_s3_file</span><span class="p">(</span><span class="n">s3_path</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">__read_csv_file</span><span class="p">(</span><span class="n">file_content</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">__parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading or processing the S3 file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_rules_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_rules_config</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_rules_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve configuration rules based on the specified source.</p>
<p>Dispatches to the appropriate loader according to the format of <code>source</code>,
returning a list of parsed rule dictionaries.</p>


<details class="supported-sources" open>
  <summary>Supported sources</summary>
  <ul>
<li><code>bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;</code></li>
<li><code>s3://&lt;bucket&gt;/&lt;path&gt;</code></li>
<li><code>&lt;file&gt;.csv</code></li>
<li><code>"mysql"</code> or <code>"postgresql"</code> (requires host/user/etc. in kwargs)</li>
<li><code>"glue"</code> (AWS Glue Data Catalog)</li>
<li><code>duckdb://&lt;db_path&gt;.&lt;table&gt;</code></li>
<li><code>databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;</code></li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier of the rules configuration location. Determines which
handler is invoked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loader-specific parameters (e.g. <code>host</code>, <code>user</code>, <code>password</code>,
<code>connection</code>, <code>query</code>).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]:
A list of dictionaries, each representing a validation rule with keys
like <code>"field"</code>, <code>"check_type"</code>, <code>"value"</code>, <code>"threshold"</code>, and <code>"execute"</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>source</code> does not match any supported format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rules_config</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve configuration rules based on the specified source.</span>

<span class="sd">    Dispatches to the appropriate loader according to the format of `source`,</span>
<span class="sd">    returning a list of parsed rule dictionaries.</span>

<span class="sd">    Supported sources:</span>
<span class="sd">      - `bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;`</span>
<span class="sd">      - `s3://&lt;bucket&gt;/&lt;path&gt;`</span>
<span class="sd">      - `&lt;file&gt;.csv`</span>
<span class="sd">      - `&quot;mysql&quot;` or `&quot;postgresql&quot;` (requires host/user/etc. in kwargs)</span>
<span class="sd">      - `&quot;glue&quot;` (AWS Glue Data Catalog)</span>
<span class="sd">      - `duckdb://&lt;db_path&gt;.&lt;table&gt;`</span>
<span class="sd">      - `databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;`</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str):</span>
<span class="sd">            Identifier of the rules configuration location. Determines which</span>
<span class="sd">            handler is invoked.</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            Loader-specific parameters (e.g. `host`, `user`, `password`,</span>
<span class="sd">            `connection`, `query`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]:</span>
<span class="sd">            A list of dictionaries, each representing a validation rule with keys</span>
<span class="sd">            like `&quot;field&quot;`, `&quot;check_type&quot;`, `&quot;value&quot;`, `&quot;threshold&quot;`, and `&quot;execute&quot;`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If `source` does not match any supported format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bigquery://&quot;</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">project</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_config_from_bigquery</span><span class="p">(</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
                <span class="n">dataset_id</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
                <span class="n">table_id</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;s3://&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_config_from_s3</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.csv$&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_config_from_csv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;mysql&quot;</span> <span class="o">|</span> <span class="s2">&quot;postgresql&quot;</span> <span class="k">as</span> <span class="n">driver</span><span class="p">:</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">_CONFIG_DISPATCH</span><span class="p">[</span><span class="n">driver</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">loader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;glue&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_config_from_glue_data_catalog</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;duckdb://&quot;</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">db_path</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_config_from_duckdb</span><span class="p">(</span>
                <span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span>
                <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;databricks://&quot;</span><span class="p">):</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">__parse_databricks_uri</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_config_from_databricks</span><span class="p">(</span>
                <span class="n">catalog</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;catalog&quot;</span><span class="p">],</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">],</span>
                <span class="n">table</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;table&quot;</span><span class="p">],</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknow source: </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_config</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the schema configuration based on the provided data source.</p>
<p>This function determines the appropriate method to extract schema information
based on the format or type of the <code>source</code> string. It supports various data
sources such as BigQuery, S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB,
and Databricks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the data source. The format of the
string determines the method used to retrieve the schema. Supported
formats include: <code>bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;</code>, <code>s3://&lt;bucket&gt;/&lt;path&gt;</code>, 
<code>&lt;file&gt;.csv</code>, <code>mysql</code>, <code>postgresql</code>, <code>glue</code>, <code>duckdb://&lt;db_path&gt;.&lt;table&gt;</code>, 
<code>databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments required by specific schema
retrieval methods. For example:
For DuckDB: <code>conn</code> (a database connection object).
For other sources: Additional parameters specific to the source.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries representing the schema</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration. Each dictionary contains details about a column in the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>schema.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>source</code> string does not match any supported format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;bigquery://my_project.my_dataset.my_table&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;s3://my_bucket/my_file.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_schema_config</span><span class="p">(</span><span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_config</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the schema configuration based on the provided data source.</span>

<span class="sd">    This function determines the appropriate method to extract schema information</span>
<span class="sd">    based on the format or type of the `source` string. It supports various data</span>
<span class="sd">    sources such as BigQuery, S3, CSV files, MySQL, PostgreSQL, AWS Glue, DuckDB,</span>
<span class="sd">    and Databricks.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): </span>
<span class="sd">            A string representing the data source. The format of the</span>
<span class="sd">            string determines the method used to retrieve the schema. Supported</span>
<span class="sd">            formats include: `bigquery://&lt;project&gt;.&lt;dataset&gt;.&lt;table&gt;`, `s3://&lt;bucket&gt;/&lt;path&gt;`, </span>
<span class="sd">            `&lt;file&gt;.csv`, `mysql`, `postgresql`, `glue`, `duckdb://&lt;db_path&gt;.&lt;table&gt;`, </span>
<span class="sd">            `databricks://&lt;catalog&gt;.&lt;schema&gt;.&lt;table&gt;`</span>
<span class="sd">        **kwargs: Additional keyword arguments required by specific schema</span>
<span class="sd">            retrieval methods. For example:</span>
<span class="sd">            For DuckDB: `conn` (a database connection object).</span>
<span class="sd">            For other sources: Additional parameters specific to the source.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the schema</span>
<span class="sd">        configuration. Each dictionary contains details about a column in the</span>
<span class="sd">        schema.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the `source` string does not match any supported format.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;bigquery://my_project.my_dataset.my_table&quot;)</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;s3://my_bucket/my_file.csv&quot;)</span>
<span class="sd">        &gt;&gt;&gt; get_schema_config(&quot;mysql&quot;, host=&quot;localhost&quot;, user=&quot;root&quot;, password=&quot;password&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bigquery://&quot;</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">project</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_bigquery</span><span class="p">(</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
                <span class="n">dataset_id</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
                <span class="n">table_id</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;s3://&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_schema_from_s3</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.csv$&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">get_schema_from_csv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;mysql&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_schema_from_mysql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_schema_from_postgresql</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;glue&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_schema_from_glue</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;duckdb://&quot;</span><span class="p">):</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">db_path</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_duckdb</span><span class="p">(</span><span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;databricks://&quot;</span><span class="p">):</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">__parse_databricks_uri</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get_schema_from_databricks</span><span class="p">(</span>
                <span class="n">catalog</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;catalog&quot;</span><span class="p">],</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">],</span>
                <span class="n">table</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="s2">&quot;table&quot;</span><span class="p">],</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknow source: </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_bigquery" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_bigquery</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">table_id</span><span class="p">,</span> <span class="n">credentials_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_bigquery" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_bigquery</span><span class="p">(</span>
    <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">credentials_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">google.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">bigquery</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
        <span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="p">(</span>
            <span class="kc">None</span>
            <span class="k">if</span> <span class="n">credentials_path</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span><span class="n">credentials_path</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">schema_field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">schema_field</span><span class="o">.</span><span class="n">field_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">schema_field</span><span class="o">.</span><span class="n">is_nullable</span><span class="p">,</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">schema_field</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">schema</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_csv" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_csv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_csv</span><span class="p">(</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>

    <span class="n">cols</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">sample_size</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;type_hints&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
                    <span class="p">},</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">raw</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">[</span><span class="s2">&quot;nullable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">continue</span>
                <span class="n">info</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>
                <span class="n">info</span><span class="p">[</span><span class="s2">&quot;type_hints&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">infer_basic_type</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>

    <span class="n">out</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">cols</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">hints</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;type_hints&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">hints</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;integer&quot;</span><span class="p">}:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;integer&quot;</span>
        <span class="k">elif</span> <span class="n">hints</span> <span class="o">&lt;=</span> <span class="p">{</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">}:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;float&quot;</span>
        <span class="k">elif</span> <span class="n">hints</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">}:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;date&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">],</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">dtype</span><span class="p">,</span>
                <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;nullable&quot;</span><span class="p">],</span>
                <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_databricks" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_databricks</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_databricks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_databricks</span><span class="p">(</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">catalog</span> <span class="ow">and</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">table</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">full</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">dataType</span><span class="o">.</span><span class="n">simpleString</span><span class="p">(),</span>
                <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_duckdb" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_duckdb</span><span class="p">(</span><span class="n">db_path</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_duckdb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_duckdb</span><span class="p">(</span><span class="n">db_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PRAGMA table_info(&#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchdf</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;notnull&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_glue" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_glue</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_glue" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_glue</span><span class="p">(</span>
    <span class="n">glue_context</span><span class="p">,</span> <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">awsglue.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlueContext</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">glue_context</span><span class="p">,</span> <span class="n">GlueContext</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Informe um GlueContext válido&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">glue_context</span><span class="o">.</span><span class="n">spark_session</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">database_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">dataType</span><span class="o">.</span><span class="n">simpleString</span><span class="p">(),</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">fields</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_mysql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_mysql</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_mysql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_mysql</span><span class="p">(</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3306</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">mysql.connector</span>

    <span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span>
    <span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">dictionary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            column_name AS field,</span>
<span class="s2">            data_type,</span>
<span class="s2">            is_nullable = &#39;YES&#39; AS nullable,</span>
<span class="s2">            character_maximum_length AS max_length</span>
<span class="s2">        FROM information_schema.columns</span>
<span class="s2">        WHERE table_schema = %s AND table_name = %s</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">table</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_postgresql" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_postgresql</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_postgresql" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_postgresql</span><span class="p">(</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5432</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">psycopg2</span>

    <span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">dbname</span><span class="o">=</span><span class="n">database</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span>
    <span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT</span>
<span class="s2">            column_name AS field,</span>
<span class="s2">            data_type,</span>
<span class="s2">            is_nullable = &#39;YES&#39; AS nullable,</span>
<span class="s2">            character_maximum_length AS max_length</span>
<span class="s2">        FROM information_schema.columns</span>
<span class="s2">        WHERE table_schema = &#39;public&#39; AND table_name = %s</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">table</span><span class="p">,),</span>
    <span class="p">)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span> <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="n">nl</span><span class="p">,</span> <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="n">ml</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nl</span><span class="p">,</span> <span class="n">ml</span> <span class="ow">in</span> <span class="n">cols</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.get_schema_from_s3" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_schema_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.get_schema_from_s3" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/config.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_schema_from_s3</span><span class="p">(</span><span class="n">s3_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">__read_s3_file</span><span class="p">(</span><span class="n">s3_path</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/temp.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_schema_from_csv</span><span class="p">(</span><span class="s2">&quot;/tmp/temp.csv&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.report" class="doc doc-heading">
            <code class=" language-python"><span class="n">report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Quality Check&#39;</span><span class="p">)</span></code>

<a href="#sumeh.core.report" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs a quality check on the given DataFrame based on the provided rules.</p>
<p>The function iterates over a list of rules and applies different checks to the
specified fields of the DataFrame. The checks include validation of completeness,
uniqueness, specific values, patterns, and other conditions. Each rule corresponds
to a particular type of validation, such as 'is_complete', 'is_greater_than',
'has_mean', etc. After applying the checks, the function returns the result of
the validation.</p>
<p>Parameters:
- df (DataFrame): The DataFrame to be validated.
- rules (list of dict): A list of rules defining the checks to be performed.
    Each rule is a dictionary with the following keys:
    - "check_type": The type of check to apply.
    - "field": The column of the DataFrame to check.
    - "value" (optional): The value used for comparison in some checks (e.g., for 'is_greater_than').
    - "threshold" (optional): A percentage threshold to be applied in some checks.
- name (str): The name of the quality check (default is "Quality Check").</p>
<p>Returns:
- quality_check (CheckResult): The result of the quality validation.</p>
<p>Warnings:
- If an unknown rule name is encountered, a warning is generated.</p>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Quality Check&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a quality check on the given DataFrame based on the provided rules.</span>

<span class="sd">    The function iterates over a list of rules and applies different checks to the</span>
<span class="sd">    specified fields of the DataFrame. The checks include validation of completeness,</span>
<span class="sd">    uniqueness, specific values, patterns, and other conditions. Each rule corresponds</span>
<span class="sd">    to a particular type of validation, such as &#39;is_complete&#39;, &#39;is_greater_than&#39;,</span>
<span class="sd">    &#39;has_mean&#39;, etc. After applying the checks, the function returns the result of</span>
<span class="sd">    the validation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (DataFrame): The DataFrame to be validated.</span>
<span class="sd">    - rules (list of dict): A list of rules defining the checks to be performed.</span>
<span class="sd">        Each rule is a dictionary with the following keys:</span>
<span class="sd">        - &quot;check_type&quot;: The type of check to apply.</span>
<span class="sd">        - &quot;field&quot;: The column of the DataFrame to check.</span>
<span class="sd">        - &quot;value&quot; (optional): The value used for comparison in some checks (e.g., for &#39;is_greater_than&#39;).</span>
<span class="sd">        - &quot;threshold&quot; (optional): A percentage threshold to be applied in some checks.</span>
<span class="sd">    - name (str): The name of the quality check (default is &quot;Quality Check&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - quality_check (CheckResult): The result of the quality validation.</span>

<span class="sd">    Warnings:</span>
<span class="sd">    - If an unknown rule name is encountered, a warning is generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check</span> <span class="o">=</span> <span class="n">Check</span><span class="p">(</span><span class="n">CheckLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;check_type&quot;</span><span class="p">]</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">threshold</span>

        <span class="k">match</span> <span class="n">rule_name</span><span class="p">:</span>

            <span class="k">case</span> <span class="s2">&quot;is_complete&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_unique&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_unique</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_primary_key&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_primary_key</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;are_complete&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;are_unique&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_composite_key&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">are_complete</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_greater_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_greater_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_positive&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_positive</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_negative&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_negative</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_greater_or_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_greater_or_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_less_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_less_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_less_or_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_less_or_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_equal_than&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_equal_than</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_contained_in&quot;</span> <span class="o">|</span> <span class="s2">&quot;is_in&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_contained_in</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;not_contained_in&quot;</span> <span class="o">|</span> <span class="s2">&quot;not_in&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_contained_in</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_between&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_pattern&quot;</span><span class="p">:</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_pattern</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_legit&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_legit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_min&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_min</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_max&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_max</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_std&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_std</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_mean&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_mean</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_sum&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_sum</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_cardinality&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_cardinality</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_infogain&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_infogain</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;has_entropy&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">has_entropy</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_in_millions&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_in_millions</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_in_billions&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_in_millions</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_1&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_1</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_2&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_2</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_t_minus_3&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_t_minus_3</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_today&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_today</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_yesterday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_yesterday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_weekday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_weekday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_weekend&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_weekend</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_monday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_monday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_tuesday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_tuesday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_wednesday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_wednesday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_thursday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_thursday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_friday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_friday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_saturday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_saturday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;is_on_sunday&quot;</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">is_on_sunday</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;satisfies&quot;</span><span class="p">:</span>
                <span class="n">predicate</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">satisfies</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown rule name: </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">quality_check</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quality_check</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.summarize" class="doc doc-heading">
            <code class=" language-python"><span class="n">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#sumeh.core.summarize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Summarizes a DataFrame based on the provided rules and context.</p>
<p>This function dynamically detects the appropriate engine to use for summarization
based on the type of the input DataFrame. It delegates the summarization process
to the corresponding engine module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input DataFrame to be summarized. The type of the DataFrame determines
the engine used for summarization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries defining the summarization rules.
Each dictionary specifies the operations or transformations to be applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context parameters required by specific engines. Common
parameters include:
- conn: A database connection object (used by certain engines like DuckDB).
- total_rows: The total number of rows in the DataFrame (optional).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The summarized DataFrame as processed by the appropriate engine.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the type of the input DataFrame is unsupported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function uses the <code>__detect_engine</code> method to determine the engine name
  based on the input DataFrame.</li>
<li>Supported engines are dynamically imported from the <code>sumeh.engine</code> package.</li>
<li>The "duckdb_engine" case requires a database connection (<code>conn</code>) to be passed
  in the context.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>summarized_df = summarize(df, rules=[{"operation": "sum", "column": "sales"}], conn=my_conn)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summarizes a DataFrame based on the provided rules and context.</span>

<span class="sd">    This function dynamically detects the appropriate engine to use for summarization</span>
<span class="sd">    based on the type of the input DataFrame. It delegates the summarization process</span>
<span class="sd">    to the corresponding engine module.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: The input DataFrame to be summarized. The type of the DataFrame determines</span>
<span class="sd">            the engine used for summarization.</span>
<span class="sd">        rules (list[dict]): A list of dictionaries defining the summarization rules.</span>
<span class="sd">            Each dictionary specifies the operations or transformations to be applied.</span>
<span class="sd">        **context: Additional context parameters required by specific engines. Common</span>
<span class="sd">            parameters include:</span>
<span class="sd">            - conn: A database connection object (used by certain engines like DuckDB).</span>
<span class="sd">            - total_rows: The total number of rows in the DataFrame (optional).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The summarized DataFrame as processed by the appropriate engine.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the type of the input DataFrame is unsupported.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function uses the `__detect_engine` method to determine the engine name</span>
<span class="sd">          based on the input DataFrame.</span>
<span class="sd">        - Supported engines are dynamically imported from the `sumeh.engine` package.</span>
<span class="sd">        - The &quot;duckdb_engine&quot; case requires a database connection (`conn`) to be passed</span>
<span class="sd">          in the context.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; summarized_df = summarize(df, rules=[{&quot;operation&quot;: &quot;sum&quot;, &quot;column&quot;: &quot;sales&quot;}], conn=my_conn)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">match</span> <span class="n">engine_name</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;duckdb_engine&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span>
                <span class="n">df_rel</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">rules</span><span class="o">=</span><span class="n">rules</span><span class="p">,</span>
                <span class="n">conn</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">),</span>
                <span class="n">total_rows</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_rows&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">total_rows</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_rows&quot;</span><span class="p">))</span>

    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported DataFrame type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.validate" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#sumeh.core.validate" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates a DataFrame against a set of rules using the appropriate engine.</p>
<p>This function dynamically detects the engine to use based on the input
DataFrame and delegates the validation process to the corresponding engine's
implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input DataFrame to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span> or <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validation rules to be applied to the DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**context</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context parameters that may be required by the engine.
- conn (optional): A database connection object, required for certain engines
  like "duckdb_engine".</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool or dict: The result of the validation process. The return type and structure</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>depend on the specific engine's implementation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the required engine module cannot be imported.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the detected engine does not have a <code>validate</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The engine is dynamically determined based on the DataFrame type or other
  characteristics.</li>
<li>For "duckdb_engine", a database connection object should be provided in the
  context under the key "conn".</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a DataFrame against a set of rules using the appropriate engine.</span>

<span class="sd">    This function dynamically detects the engine to use based on the input</span>
<span class="sd">    DataFrame and delegates the validation process to the corresponding engine&#39;s</span>
<span class="sd">    implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The input DataFrame to be validated.</span>
<span class="sd">        rules (list or dict): The validation rules to be applied to the DataFrame.</span>
<span class="sd">        **context: Additional context parameters that may be required by the engine.</span>
<span class="sd">            - conn (optional): A database connection object, required for certain engines</span>
<span class="sd">              like &quot;duckdb_engine&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool or dict: The result of the validation process. The return type and structure</span>
<span class="sd">        depend on the specific engine&#39;s implementation.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the required engine module cannot be imported.</span>
<span class="sd">        AttributeError: If the detected engine does not have a `validate` method.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The engine is dynamically determined based on the DataFrame type or other</span>
<span class="sd">          characteristics.</span>
<span class="sd">        - For &quot;duckdb_engine&quot;, a database connection object should be provided in the</span>
<span class="sd">          context under the key &quot;conn&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">match</span> <span class="n">engine_name</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;duckdb_engine&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conn&quot;</span><span class="p">))</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.core.validate_schema" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate_schema</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span><span class="p">)</span></code>

<a href="#sumeh.core.validate_schema" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates the schema of a given data source or connection against an expected schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_or_conn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data source or connection to validate. This can be a DataFrame, 
              database connection, or other supported data structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries defining the expected schema. 
                             Each dictionary should describe a column or field, 
                             including its name, type, and other attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>engine</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the engine to use for validation. This determines the 
          specific validation logic to apply based on the data source type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**engine_kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the engine's validation logic.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating 
                                whether the schema is valid, and the second element is 
                                a list of tuples containing error messages for any 
                                validation failures. Each tuple consists of the field 
                                name and the corresponding error message.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/core.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_schema</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the schema of a given data source or connection against an expected schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_or_conn (Any): The data source or connection to validate. This can be a DataFrame, </span>
<span class="sd">                          database connection, or other supported data structure.</span>
<span class="sd">        expected (List[Dict[str, Any]]): A list of dictionaries defining the expected schema. </span>
<span class="sd">                                         Each dictionary should describe a column or field, </span>
<span class="sd">                                         including its name, type, and other attributes.</span>
<span class="sd">        engine (str): The name of the engine to use for validation. This determines the </span>
<span class="sd">                      specific validation logic to apply based on the data source type.</span>
<span class="sd">        **engine_kwargs: Additional keyword arguments to pass to the engine&#39;s validation logic.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating </span>
<span class="sd">                                            whether the schema is valid, and the second element is </span>
<span class="sd">                                            a list of tuples containing error messages for any </span>
<span class="sd">                                            validation failures. Each tuple consists of the field </span>
<span class="sd">                                            name and the corresponding error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="n">__detect_engine</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">)</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sumeh.engine.</span><span class="si">{</span><span class="n">engine_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">engine</span><span class="o">.</span><span class="n">validate_schema</span><span class="p">(</span><span class="n">df_or_conn</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="n">expected</span><span class="p">,</span> <span class="o">**</span><span class="n">engine_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>