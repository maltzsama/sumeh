
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Library for Data Quality checks">
      
      
        <meta name="author" content="Demetrius Albuquerque">
      
      
      
        <link rel="prev" href="../engines/">
      
      
        <link rel="next" href="../engine-duckdb/">
      
      
      <link rel="icon" href="../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>dask engine - Sumeh DQ — Unified Data Quality Framework</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-sumehenginedask_engine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-header__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../../img/sumeh.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sumeh DQ — Unified Data Quality Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              dask engine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-nav__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../../img/sumeh.svg" alt="logo">

    </a>
    Sumeh DQ — Unified Data Quality Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/services-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/services-utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    services utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    engines
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            engines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    engine overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    dask engine
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    dask engine
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__compare_schemas" class="md-nav__link">
    <span class="md-ellipsis">
      __compare_schemas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__dask_schema_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      __dask_schema_to_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__extract_params" class="md-nav__link">
    <span class="md-ellipsis">
      __extract_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine._rules_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      _rules_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.all_date_checks" class="md-nav__link">
    <span class="md-ellipsis">
      all_date_checks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.are_complete" class="md-nav__link">
    <span class="md-ellipsis">
      are_complete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.are_unique" class="md-nav__link">
    <span class="md-ellipsis">
      are_unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_cardinality" class="md-nav__link">
    <span class="md-ellipsis">
      has_cardinality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_entropy" class="md-nav__link">
    <span class="md-ellipsis">
      has_entropy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_infogain" class="md-nav__link">
    <span class="md-ellipsis">
      has_infogain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_max" class="md-nav__link">
    <span class="md-ellipsis">
      has_max
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_mean" class="md-nav__link">
    <span class="md-ellipsis">
      has_mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_min" class="md-nav__link">
    <span class="md-ellipsis">
      has_min
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      has_pattern
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_std" class="md-nav__link">
    <span class="md-ellipsis">
      has_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_sum" class="md-nav__link">
    <span class="md-ellipsis">
      has_sum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_between" class="md-nav__link">
    <span class="md-ellipsis">
      is_between
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_complete" class="md-nav__link">
    <span class="md-ellipsis">
      is_complete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_composite_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_composite_key
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_contained_in" class="md-nav__link">
    <span class="md-ellipsis">
      is_contained_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_after" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_after
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_before" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_before
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_between" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_between
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_equal" class="md-nav__link">
    <span class="md-ellipsis">
      is_equal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_future_date" class="md-nav__link">
    <span class="md-ellipsis">
      is_future_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_greater_or_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_greater_or_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_greater_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_greater_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_legit" class="md-nav__link">
    <span class="md-ellipsis">
      is_legit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_less_or_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_less_or_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_less_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_less_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_negative" class="md-nav__link">
    <span class="md-ellipsis">
      is_negative
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_past_date" class="md-nav__link">
    <span class="md-ellipsis">
      is_past_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_positive" class="md-nav__link">
    <span class="md-ellipsis">
      is_positive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_primary_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_primary_key
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_unique" class="md-nav__link">
    <span class="md-ellipsis">
      is_unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.not_contained_in" class="md-nav__link">
    <span class="md-ellipsis">
      not_contained_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.satisfies" class="md-nav__link">
    <span class="md-ellipsis">
      satisfies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate_date_format" class="md-nav__link">
    <span class="md-ellipsis">
      validate_date_format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine-duckdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    duckDB engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine-polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polars engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine-pyspark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pyspark engine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__compare_schemas" class="md-nav__link">
    <span class="md-ellipsis">
      __compare_schemas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__convert_value" class="md-nav__link">
    <span class="md-ellipsis">
      __convert_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__dask_schema_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      __dask_schema_to_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.__extract_params" class="md-nav__link">
    <span class="md-ellipsis">
      __extract_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine._rules_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      _rules_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.all_date_checks" class="md-nav__link">
    <span class="md-ellipsis">
      all_date_checks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.are_complete" class="md-nav__link">
    <span class="md-ellipsis">
      are_complete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.are_unique" class="md-nav__link">
    <span class="md-ellipsis">
      are_unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_cardinality" class="md-nav__link">
    <span class="md-ellipsis">
      has_cardinality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_entropy" class="md-nav__link">
    <span class="md-ellipsis">
      has_entropy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_infogain" class="md-nav__link">
    <span class="md-ellipsis">
      has_infogain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_max" class="md-nav__link">
    <span class="md-ellipsis">
      has_max
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_mean" class="md-nav__link">
    <span class="md-ellipsis">
      has_mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_min" class="md-nav__link">
    <span class="md-ellipsis">
      has_min
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      has_pattern
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_std" class="md-nav__link">
    <span class="md-ellipsis">
      has_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.has_sum" class="md-nav__link">
    <span class="md-ellipsis">
      has_sum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_between" class="md-nav__link">
    <span class="md-ellipsis">
      is_between
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_complete" class="md-nav__link">
    <span class="md-ellipsis">
      is_complete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_composite_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_composite_key
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_contained_in" class="md-nav__link">
    <span class="md-ellipsis">
      is_contained_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_after" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_after
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_before" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_before
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_date_between" class="md-nav__link">
    <span class="md-ellipsis">
      is_date_between
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_equal" class="md-nav__link">
    <span class="md-ellipsis">
      is_equal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_future_date" class="md-nav__link">
    <span class="md-ellipsis">
      is_future_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_greater_or_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_greater_or_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_greater_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_greater_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_legit" class="md-nav__link">
    <span class="md-ellipsis">
      is_legit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_less_or_equal_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_less_or_equal_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_less_than" class="md-nav__link">
    <span class="md-ellipsis">
      is_less_than
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_negative" class="md-nav__link">
    <span class="md-ellipsis">
      is_negative
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_past_date" class="md-nav__link">
    <span class="md-ellipsis">
      is_past_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_positive" class="md-nav__link">
    <span class="md-ellipsis">
      is_positive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_primary_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_primary_key
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.is_unique" class="md-nav__link">
    <span class="md-ellipsis">
      is_unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.not_contained_in" class="md-nav__link">
    <span class="md-ellipsis">
      not_contained_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.satisfies" class="md-nav__link">
    <span class="md-ellipsis">
      satisfies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate_date_format" class="md-nav__link">
    <span class="md-ellipsis">
      validate_date_format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumeh.engine.dask_engine.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="module-sumehenginedask_engine">Module <code>sumeh.engine.dask_engine</code><a class="headerlink" href="#module-sumehenginedask_engine" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>This module provides a set of data quality validation functions for Dask DataFrames.
It includes various checks such as completeness, uniqueness, value range, patterns,
and schema validation. The module also provides utilities for summarizing validation
results and schema comparison.</p>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_positive(df, rule) (sumeh.engine.dask_engine.is_positive)" href="#sumeh.engine.dask_engine.is_positive">is_positive</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_negative(df, rule) (sumeh.engine.dask_engine.is_negative)" href="#sumeh.engine.dask_engine.is_negative">is_negative</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_complete(df, rule) (sumeh.engine.dask_engine.is_complete)" href="#sumeh.engine.dask_engine.is_complete">is_complete</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_unique(df, rule) (sumeh.engine.dask_engine.is_unique)" href="#sumeh.engine.dask_engine.is_unique">is_unique</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="are_complete(df, rule) (sumeh.engine.dask_engine.are_complete)" href="#sumeh.engine.dask_engine.are_complete">are_complete</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="are_unique(df, rule) (sumeh.engine.dask_engine.are_unique)" href="#sumeh.engine.dask_engine.are_unique">are_unique</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_greater_than(df, rule) (sumeh.engine.dask_engine.is_greater_than)" href="#sumeh.engine.dask_engine.is_greater_than">is_greater_than</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_greater_or_equal_than(df, rule) (sumeh.engine.dask_engine.is_greater_or_equal_than)" href="#sumeh.engine.dask_engine.is_greater_or_equal_than">is_greater_or_equal_than</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_less_than(df, rule) (sumeh.engine.dask_engine.is_less_than)" href="#sumeh.engine.dask_engine.is_less_than">is_less_than</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_less_or_equal_than(df, rule) (sumeh.engine.dask_engine.is_less_or_equal_than)" href="#sumeh.engine.dask_engine.is_less_or_equal_than">is_less_or_equal_than</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_equal(df, rule) (sumeh.engine.dask_engine.is_equal)" href="#sumeh.engine.dask_engine.is_equal">is_equal</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_equal_than(df, rule) (sumeh.engine.dask_engine.is_equal_than)" href="#sumeh.engine.dask_engine.is_equal_than">is_equal_than</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_contained_in(df, rule) (sumeh.engine.dask_engine.is_contained_in)" href="#sumeh.engine.dask_engine.is_contained_in">is_contained_in</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="not_contained_in(df, rule) (sumeh.engine.dask_engine.not_contained_in)" href="#sumeh.engine.dask_engine.not_contained_in">not_contained_in</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_between(df, rule) (sumeh.engine.dask_engine.is_between)" href="#sumeh.engine.dask_engine.is_between">is_between</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_pattern(df, rule) (sumeh.engine.dask_engine.has_pattern)" href="#sumeh.engine.dask_engine.has_pattern">has_pattern</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_legit(df, rule) (sumeh.engine.dask_engine.is_legit)" href="#sumeh.engine.dask_engine.is_legit">is_legit</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_primary_key(df, rule) (sumeh.engine.dask_engine.is_primary_key)" href="#sumeh.engine.dask_engine.is_primary_key">is_primary_key</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_composite_key(df, rule) (sumeh.engine.dask_engine.is_composite_key)" href="#sumeh.engine.dask_engine.is_composite_key">is_composite_key</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_max(df, rule) (sumeh.engine.dask_engine.has_max)" href="#sumeh.engine.dask_engine.has_max">has_max</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_min(df, rule) (sumeh.engine.dask_engine.has_min)" href="#sumeh.engine.dask_engine.has_min">has_min</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_std(df, rule) (sumeh.engine.dask_engine.has_std)" href="#sumeh.engine.dask_engine.has_std">has_std</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_mean(df, rule) (sumeh.engine.dask_engine.has_mean)" href="#sumeh.engine.dask_engine.has_mean">has_mean</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_sum(df, rule) (sumeh.engine.dask_engine.has_sum)" href="#sumeh.engine.dask_engine.has_sum">has_sum</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_cardinality(df, rule) (sumeh.engine.dask_engine.has_cardinality)" href="#sumeh.engine.dask_engine.has_cardinality">has_cardinality</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_infogain(df, rule) (sumeh.engine.dask_engine.has_infogain)" href="#sumeh.engine.dask_engine.has_infogain">has_infogain</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="has_entropy(df, rule) (sumeh.engine.dask_engine.has_entropy)" href="#sumeh.engine.dask_engine.has_entropy">has_entropy</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="satisfies(df, rule) (sumeh.engine.dask_engine.satisfies)" href="#sumeh.engine.dask_engine.satisfies">satisfies</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rule: dict) -&gt; dd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate(df, rules) (sumeh.engine.dask_engine.validate)" href="#sumeh.engine.dask_engine.validate">validate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rules: list[dict]) -&gt; tuple[dd.DataFrame, dd.DataFrame]:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="summarize(qc_ddf, rules, total_rows) (sumeh.engine.dask_engine.summarize)" href="#sumeh.engine.dask_engine.summarize">summarize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, rules: list[dict], total_rows: int) -&gt; pd.DataFrame:</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate_schema(df, expected) (sumeh.engine.dask_engine.validate_schema)" href="#sumeh.engine.dask_engine.validate_schema">validate_schema</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>dd.DataFrame, expected: List[Dict[str, Any]]) -&gt; Tuple[bool, List[Tuple[str, str]]]:</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.__compare_schemas" class="doc doc-heading">
            <code class=" language-python"><span class="n">__compare_schemas</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.__compare_schemas" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Compare two lists of schema definitions and identify discrepancies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actual</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="SchemaDef = Dict[str, Any]

  
      module-attribute
   (sumeh.services.utils.SchemaDef)" href="../../services/services-utils/#sumeh.services.utils.SchemaDef">SchemaDef</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of actual schema definitions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="SchemaDef = Dict[str, Any]

  
      module-attribute
   (sumeh.services.utils.SchemaDef)" href="../../services/services-utils/#sumeh.services.utils.SchemaDef">SchemaDef</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of expected schema definitions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether the schemas match (True if they match, False otherwise), and the second element </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is a list of tuples describing the discrepancies. Each tuple contains:
- The field name (str).
- A description of the discrepancy (str), such as "missing", "type mismatch", 
  "nullable but expected non-nullable", or "extra column".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>A field is considered "missing" if it exists in the expected schema but not in the actual schema.</li>
<li>A "type mismatch" occurs if the data type of a field in the actual schema does not match 
  the expected data type.</li>
<li>A field is considered "nullable but expected non-nullable" if it is nullable in the actual 
  schema but not nullable in the expected schema.</li>
<li>An "extra column" is a field that exists in the actual schema but not in the expected schema.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__compare_schemas</span><span class="p">(</span><span class="n">actual</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SchemaDef</span><span class="p">],</span> <span class="n">expected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SchemaDef</span><span class="p">],)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare two lists of schema definitions and identify discrepancies.</span>

<span class="sd">    Args:</span>
<span class="sd">        actual (List[SchemaDef]): The list of actual schema definitions.</span>
<span class="sd">        expected (List[SchemaDef]): The list of expected schema definitions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating </span>
<span class="sd">        whether the schemas match (True if they match, False otherwise), and the second element </span>
<span class="sd">        is a list of tuples describing the discrepancies. Each tuple contains:</span>
<span class="sd">            - The field name (str).</span>
<span class="sd">            - A description of the discrepancy (str), such as &quot;missing&quot;, &quot;type mismatch&quot;, </span>
<span class="sd">              &quot;nullable but expected non-nullable&quot;, or &quot;extra column&quot;.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - A field is considered &quot;missing&quot; if it exists in the expected schema but not in the actual schema.</span>
<span class="sd">        - A &quot;type mismatch&quot; occurs if the data type of a field in the actual schema does not match </span>
<span class="sd">          the expected data type.</span>
<span class="sd">        - A field is considered &quot;nullable but expected non-nullable&quot; if it is nullable in the actual </span>
<span class="sd">          schema but not nullable in the expected schema.</span>
<span class="sd">        - An &quot;extra column&quot; is a field that exists in the actual schema but not in the expected schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">exp_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">expected</span><span class="p">}</span>
    <span class="n">act_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">actual</span><span class="p">}</span>

    <span class="n">erros</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">fld</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">exp_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">fld</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">act_map</span><span class="p">:</span>
            <span class="n">erros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fld</span><span class="p">,</span> <span class="s2">&quot;missing&quot;</span><span class="p">))</span>
            <span class="k">continue</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">act_map</span><span class="p">[</span><span class="n">fld</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">act</span><span class="p">[</span><span class="s2">&quot;data_type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">exp</span><span class="p">[</span><span class="s2">&quot;data_type&quot;</span><span class="p">]:</span>
            <span class="n">erros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">fld</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;type mismatch (got </span><span class="si">{</span><span class="n">act</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">act</span><span class="p">[</span><span class="s2">&quot;nullable&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">exp</span><span class="p">[</span><span class="s2">&quot;nullable&quot;</span><span class="p">]:</span>
            <span class="n">erros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fld</span><span class="p">,</span> <span class="s2">&quot;nullable but expected non-nullable&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_length&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="c1"># 2. campos extras (se quiser)</span>
    <span class="n">extras</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">act_map</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">exp_map</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">fld</span> <span class="ow">in</span> <span class="n">extras</span><span class="p">:</span>
        <span class="n">erros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fld</span><span class="p">,</span> <span class="s2">&quot;extra column&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">erros</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">erros</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.__convert_value" class="doc doc-heading">
            <code class=" language-python"><span class="n">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.__convert_value" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts the provided value to the appropriate type (date, float, or int).</p>
<p>Depending on the format of the input value, it will be converted to a datetime object,
a floating-point number (float), or an integer (int).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be converted, represented as a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the value does not match an expected format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__convert_value</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the provided value to the appropriate type (date, float, or int).</span>

<span class="sd">    Depending on the format of the input value, it will be converted to a datetime object,</span>
<span class="sd">    a floating-point number (float), or an integer (int).</span>

<span class="sd">    Args:</span>
<span class="sd">        value (str): The value to be converted, represented as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[datetime, float, int]: The converted value, which can be a datetime object, float, or int.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the value does not match an expected format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.__dask_schema_to_list" class="doc doc-heading">
            <code class=" language-python"><span class="n">__dask_schema_to_list</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.__dask_schema_to_list" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert the schema of a Dask DataFrame into a list of dictionaries.</p>
<p>Each dictionary in the resulting list represents a column in the DataFrame
and contains metadata about the column, including its name, data type,
nullability, and maximum length.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame whose schema is to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: A list of dictionaries, where each dictionary</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>contains the following keys:
- "field" (str): The name of the column.
- "data_type" (str): The data type of the column, converted to a lowercase string.
- "nullable" (bool): Always set to True, indicating the column is nullable.
- "max_length" (None): Always set to None, as maximum length is not determined.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__dask_schema_to_list</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the schema of a Dask DataFrame into a list of dictionaries.</span>

<span class="sd">    Each dictionary in the resulting list represents a column in the DataFrame</span>
<span class="sd">    and contains metadata about the column, including its name, data type,</span>
<span class="sd">    nullability, and maximum length.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame whose schema is to be converted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries, where each dictionary</span>
<span class="sd">        contains the following keys:</span>
<span class="sd">            - &quot;field&quot; (str): The name of the column.</span>
<span class="sd">            - &quot;data_type&quot; (str): The data type of the column, converted to a lowercase string.</span>
<span class="sd">            - &quot;nullable&quot; (bool): Always set to True, indicating the column is nullable.</span>
<span class="sd">            - &quot;max_length&quot; (None): Always set to None, as maximum length is not determined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="s2">&quot;nullable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.__extract_params" class="doc doc-heading">
            <code class=" language-python"><span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.__extract_params" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>sumeh/services/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;check_type&quot;</span><span class="p">]</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
    <span class="n">raw_value</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">raw_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">raw_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">raw_value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">field</span><span class="p">,</span> <span class="n">rule_name</span><span class="p">,</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine._rules_to_df" class="doc doc-heading">
            <code class=" language-python"><span class="n">_rules_to_df</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine._rules_to_df" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts a list of rule dictionaries into a pandas DataFrame.</p>
<p>Each rule dictionary is expected to have the following keys:
- "field": The column(s) the rule applies to. Can be a string or a list of strings.
- "check_type": The type of rule or check being applied.
- "threshold" (optional): A numeric value representing the pass threshold. Defaults to 1.0 if not provided.
- "value" (optional): Additional value associated with the rule.
- "execute" (optional): A boolean indicating whether the rule should be executed. Defaults to True if not provided.</p>
<p>Rules with "execute" set to False are skipped. The resulting DataFrame contains unique rows based on the combination
of "column" and "rule".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries representing the rules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A DataFrame with the following columns:
- "column": The column(s) the rule applies to, joined by a comma if multiple.
- "rule": The type of rule or check being applied.
- "pass_threshold": The numeric pass threshold for the rule.
- "value": Additional value associated with the rule, if any.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_rules_to_df</span><span class="p">(</span><span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list of rule dictionaries into a pandas DataFrame.</span>

<span class="sd">    Each rule dictionary is expected to have the following keys:</span>
<span class="sd">    - &quot;field&quot;: The column(s) the rule applies to. Can be a string or a list of strings.</span>
<span class="sd">    - &quot;check_type&quot;: The type of rule or check being applied.</span>
<span class="sd">    - &quot;threshold&quot; (optional): A numeric value representing the pass threshold. Defaults to 1.0 if not provided.</span>
<span class="sd">    - &quot;value&quot; (optional): Additional value associated with the rule.</span>
<span class="sd">    - &quot;execute&quot; (optional): A boolean indicating whether the rule should be executed. Defaults to True if not provided.</span>

<span class="sd">    Rules with &quot;execute&quot; set to False are skipped. The resulting DataFrame contains unique rows based on the combination</span>
<span class="sd">    of &quot;column&quot; and &quot;rule&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        rules (list[dict]): A list of dictionaries representing the rules.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame with the following columns:</span>
<span class="sd">            - &quot;column&quot;: The column(s) the rule applies to, joined by a comma if multiple.</span>
<span class="sd">            - &quot;rule&quot;: The type of rule or check being applied.</span>
<span class="sd">            - &quot;pass_threshold&quot;: The numeric pass threshold for the rule.</span>
<span class="sd">            - &quot;value&quot;: Additional value associated with the rule, if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">coln</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="n">coln</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;check_type&quot;</span><span class="p">],</span>
                <span class="s2">&quot;pass_threshold&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.all_date_checks" class="doc doc-heading">
            <code class=" language-python"><span class="n">all_date_checks</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.all_date_checks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Applies date validation checks on a Dask DataFrame based on the provided rule.</p>
<p>This function serves as an alias for the <code>is_past_date</code> function, which performs
checks to determine if dates in the DataFrame meet the specified criteria.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame containing the data to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary specifying the validation rules to be applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A Dask DataFrame with the results of the date validation checks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">all_date_checks</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies date validation checks on a Dask DataFrame based on the provided rule.</span>

<span class="sd">    This function serves as an alias for the `is_past_date` function, which performs</span>
<span class="sd">    checks to determine if dates in the DataFrame meet the specified criteria.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame containing the data to be validated.</span>
<span class="sd">        rule (dict): A dictionary specifying the validation rules to be applied.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A Dask DataFrame with the results of the date validation checks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">is_past_date</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.are_complete" class="doc doc-heading">
            <code class=" language-python"><span class="n">are_complete</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.are_complete" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the specified fields in a Dask DataFrame are complete (non-null) 
based on the provided rule and returns a DataFrame of violations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to check for completeness.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should 
include the fields to check, the type of check, and the expected value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows that violate the completeness </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rule, with an additional column <code>dq_status</code> indicating the rule details </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in the format "{fields}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">are_complete</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the specified fields in a Dask DataFrame are complete (non-null) </span>
<span class="sd">    based on the provided rule and returns a DataFrame of violations.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to check for completeness.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should </span>
<span class="sd">            include the fields to check, the type of check, and the expected value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows that violate the completeness </span>
<span class="sd">        rule, with an additional column `dq_status` indicating the rule details </span>
<span class="sd">        in the format &quot;{fields}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fields</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">,</span> <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">])</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.are_unique" class="doc doc-heading">
            <code class=" language-python"><span class="n">are_unique</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.are_unique" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the specified fields in a Dask DataFrame contain unique combinations of values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It is expected to include:
- 'fields': A list of column names to check for uniqueness.
- 'check': A string describing the type of check being performed.
- 'value': A value associated with the rule (used for status reporting).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows that violate the uniqueness rule, </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> indicating the rule that was violated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">are_unique</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the specified fields in a Dask DataFrame contain unique combinations of values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It is expected to include:</span>
<span class="sd">            - &#39;fields&#39;: A list of column names to check for uniqueness.</span>
<span class="sd">            - &#39;check&#39;: A string describing the type of check being performed.</span>
<span class="sd">            - &#39;value&#39;: A value associated with the rule (used for status reporting).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows that violate the uniqueness rule, </span>
<span class="sd">        with an additional column `dq_status` indicating the rule that was violated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fields</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">combo</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="n">fields</span><span class="p">]</span>
        <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;combo&quot;</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">dupes</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">combo</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dupes</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_cardinality" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_cardinality</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_cardinality" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the cardinality (number of unique values) of a specified field in a Dask DataFrame
exceeds a given threshold and returns a modified DataFrame based on the result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The column name to check cardinality for.
- 'check' (str): A descriptive label for the check (used in the output).
- 'value' (int): The maximum allowed cardinality.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: If the cardinality of the specified field exceeds the given value, </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>returns the original DataFrame with an additional column <code>dq_status</code> indicating </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the rule violation. Otherwise, returns an empty DataFrame with the same structure </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>as the input DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_cardinality</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the cardinality (number of unique values) of a specified field in a Dask DataFrame</span>
<span class="sd">    exceeds a given threshold and returns a modified DataFrame based on the result.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to check cardinality for.</span>
<span class="sd">            - &#39;check&#39; (str): A descriptive label for the check (used in the output).</span>
<span class="sd">            - &#39;value&#39; (int): The maximum allowed cardinality.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: If the cardinality of the specified field exceeds the given value, </span>
<span class="sd">        returns the original DataFrame with an additional column `dq_status` indicating </span>
<span class="sd">        the rule violation. Otherwise, returns an empty DataFrame with the same structure </span>
<span class="sd">        as the input DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">card</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">card</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_entropy" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_entropy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluates the entropy of a specified field in a Dask DataFrame and applies a rule to determine
if the entropy exceeds a given threshold. If the threshold is exceeded, a new column <code>dq_status</code>
is added to the DataFrame with information about the rule violation. Otherwise, an empty DataFrame
is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- <code>field</code> (str): The column name to evaluate.
- <code>check</code> (str): The type of check being performed (used for status message).
- <code>value</code> (float): The threshold value for the entropy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame with the <code>dq_status</code> column added if the entropy exceeds the threshold,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>or an empty DataFrame if the threshold is not exceeded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates the entropy of a specified field in a Dask DataFrame and applies a rule to determine</span>
<span class="sd">    if the entropy exceeds a given threshold. If the threshold is exceeded, a new column `dq_status`</span>
<span class="sd">    is added to the DataFrame with information about the rule violation. Otherwise, an empty DataFrame</span>
<span class="sd">    is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - `field` (str): The column name to evaluate.</span>
<span class="sd">            - `check` (str): The type of check being performed (used for status message).</span>
<span class="sd">            - `value` (float): The threshold value for the entropy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame with the `dq_status` column added if the entropy exceeds the threshold,</span>
<span class="sd">        or an empty DataFrame if the threshold is not exceeded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">ent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">ent</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_infogain" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_infogain</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_infogain" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluates whether a given field in a Dask DataFrame satisfies an information gain condition
based on the specified rule. If the condition is met, the DataFrame is updated with a 
<code>dq_status</code> column indicating the rule applied. Otherwise, an empty DataFrame is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The column name to evaluate.
- 'check' (str): The type of check being performed (used for status annotation).
- 'value' (float): The threshold value for the information gain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: The original DataFrame with an added <code>dq_status</code> column if the condition </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is met, or an empty DataFrame if the condition is not satisfied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_infogain</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates whether a given field in a Dask DataFrame satisfies an information gain condition</span>
<span class="sd">    based on the specified rule. If the condition is met, the DataFrame is updated with a </span>
<span class="sd">    `dq_status` column indicating the rule applied. Otherwise, an empty DataFrame is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to evaluate.</span>
<span class="sd">            - &#39;check&#39; (str): The type of check being performed (used for status annotation).</span>
<span class="sd">            - &#39;value&#39; (float): The threshold value for the information gain.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: The original DataFrame with an added `dq_status` column if the condition </span>
<span class="sd">        is met, or an empty DataFrame if the condition is not satisfied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">ig</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">ig</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_max" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_max</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_max" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Identifies rows in a Dask DataFrame where the value of a specified field exceeds a given maximum value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The name of the column to check.
- 'check': A string describing the check (e.g., 'max').
- 'value': The maximum allowable value for the specified field.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule.
          An additional column <code>dq_status</code> is added to indicate the rule violation
          in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_max</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifies rows in a Dask DataFrame where the value of a specified field exceeds a given maximum value.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The name of the column to check.</span>
<span class="sd">            - &#39;check&#39;: A string describing the check (e.g., &#39;max&#39;).</span>
<span class="sd">            - &#39;value&#39;: The maximum allowable value for the specified field.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule.</span>
<span class="sd">                      An additional column `dq_status` is added to indicate the rule violation</span>
<span class="sd">                      in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_mean" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_mean</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_mean" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the mean of a specified field in a Dask DataFrame satisfies a given condition.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule to apply. It should include:
- 'field' (str): The column name to calculate the mean for.
- 'check' (str): The type of check to perform (e.g., 'greater_than').
- 'value' (float): The threshold value to compare the mean against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame with an additional column <code>dq_status</code> if the mean</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>satisfies the condition. If the condition is not met, an empty Dask DataFrame is returned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_mean</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the mean of a specified field in a Dask DataFrame satisfies a given condition.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule to apply. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to calculate the mean for.</span>
<span class="sd">            - &#39;check&#39; (str): The type of check to perform (e.g., &#39;greater_than&#39;).</span>
<span class="sd">            - &#39;value&#39; (float): The threshold value to compare the mean against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame with an additional column `dq_status` if the mean</span>
<span class="sd">        satisfies the condition. If the condition is not met, an empty Dask DataFrame is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">mean_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">mean_val</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_min" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_min</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_min" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the values in a specified field of a Dask DataFrame are greater than 
or equal to a given minimum value. Returns a DataFrame containing rows that 
violate this rule, with an additional column indicating the data quality status.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name to check.
- 'check': The type of check being performed (e.g., 'min').
- 'value': The minimum value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows that do not meet the minimum value </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>requirement, with an additional column <code>dq_status</code> indicating the rule </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>violation in the format "field:check:value".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_min</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the values in a specified field of a Dask DataFrame are greater than </span>
<span class="sd">    or equal to a given minimum value. Returns a DataFrame containing rows that </span>
<span class="sd">    violate this rule, with an additional column indicating the data quality status.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to validate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &#39;min&#39;).</span>
<span class="sd">            - &#39;value&#39;: The minimum value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows that do not meet the minimum value </span>
<span class="sd">        requirement, with an additional column `dq_status` indicating the rule </span>
<span class="sd">        violation in the format &quot;field:check:value&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_pattern" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_pattern</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_pattern" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Identifies rows in a Dask DataFrame that do not match a specified pattern.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to apply the pattern check.
- 'check': A descriptive label for the type of check being performed.
- 'value': The regex pattern to match against the specified column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows that do not match the specified pattern.
          An additional column <code>dq_status</code> is added, indicating the rule details
          in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_pattern</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifies rows in a Dask DataFrame that do not match a specified pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to apply the pattern check.</span>
<span class="sd">            - &#39;check&#39;: A descriptive label for the type of check being performed.</span>
<span class="sd">            - &#39;value&#39;: The regex pattern to match against the specified column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows that do not match the specified pattern.</span>
<span class="sd">                      An additional column `dq_status` is added, indicating the rule details</span>
<span class="sd">                      in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_std" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_std" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the standard deviation of a specified field in a Dask DataFrame exceeds a given value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The name of the column to calculate the standard deviation for.
- 'check' (str): A descriptive label for the check being performed.
- 'value' (float): The threshold value for the standard deviation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: 
- If the standard deviation of the specified field exceeds the given value, 
  returns the original DataFrame with an additional column <code>dq_status</code> indicating the rule details.
- If the standard deviation does not exceed the value, returns an empty DataFrame with the same structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_std</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the standard deviation of a specified field in a Dask DataFrame exceeds a given value.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The name of the column to calculate the standard deviation for.</span>
<span class="sd">            - &#39;check&#39; (str): A descriptive label for the check being performed.</span>
<span class="sd">            - &#39;value&#39; (float): The threshold value for the standard deviation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: </span>
<span class="sd">            - If the standard deviation of the specified field exceeds the given value, </span>
<span class="sd">              returns the original DataFrame with an additional column `dq_status` indicating the rule details.</span>
<span class="sd">            - If the standard deviation does not exceed the value, returns an empty DataFrame with the same structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">std_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">std_val</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.has_sum" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_sum</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.has_sum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the sum of a specified field in a Dask DataFrame exceeds a given value 
and returns a modified DataFrame with a status column if the condition is met.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The column name to sum.
- 'check' (str): A descriptive label for the check (used in the status message).
- 'value' (float): The threshold value to compare the sum against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame. If the sum exceeds the threshold, the DataFrame </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>will include a <code>dq_status</code> column with a status message. Otherwise, an empty </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with the same structure as the input is returned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_sum</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the sum of a specified field in a Dask DataFrame exceeds a given value </span>
<span class="sd">    and returns a modified DataFrame with a status column if the condition is met.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to sum.</span>
<span class="sd">            - &#39;check&#39; (str): A descriptive label for the check (used in the status message).</span>
<span class="sd">            - &#39;value&#39; (float): The threshold value to compare the sum against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame. If the sum exceeds the threshold, the DataFrame </span>
<span class="sd">        will include a `dq_status` column with a status message. Otherwise, an empty </span>
<span class="sd">        DataFrame with the same structure as the input is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">sum_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="ow">or</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">sum_val</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_between" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_between</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_between" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where a specified field's value 
does not fall within a given range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should 
include:
- 'field': The column name in the DataFrame to check.
- 'check': The type of check being performed (e.g., "between").
- 'value': A string representing the range in the format "[lo,hi]".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing only the rows that violate </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the specified range condition. An additional column <code>dq_status</code> is </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>added to indicate the field, check, and value that caused the violation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_between</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where a specified field&#39;s value </span>
<span class="sd">    does not fall within a given range.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should </span>
<span class="sd">            include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;between&quot;).</span>
<span class="sd">            - &#39;value&#39;: A string representing the range in the format &quot;[lo,hi]&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing only the rows that violate </span>
<span class="sd">        the specified range condition. An additional column `dq_status` is </span>
<span class="sd">        added to indicate the field, check, and value that caused the violation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">__convert_value</span><span class="p">(</span><span class="n">lo</span><span class="p">),</span> <span class="n">__convert_value</span><span class="p">(</span><span class="n">hi</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_complete" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_complete</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_complete" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks for completeness of a specified field in a Dask DataFrame based on a given rule.</p>
<p>This function identifies rows where the specified field is null and marks them as violations.
It then assigns a data quality status to these rows in the resulting DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The name of the field to check for completeness.
- 'check': The type of check being performed (e.g., 'is_complete').
- 'value': Additional value associated with the rule (not used in this function).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows where the specified field is null, </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> indicating the data quality status in the format </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_complete</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks for completeness of a specified field in a Dask DataFrame based on a given rule.</span>

<span class="sd">    This function identifies rows where the specified field is null and marks them as violations.</span>
<span class="sd">    It then assigns a data quality status to these rows in the resulting DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The name of the field to check for completeness.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &#39;is_complete&#39;).</span>
<span class="sd">            - &#39;value&#39;: Additional value associated with the rule (not used in this function).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows where the specified field is null, </span>
<span class="sd">        with an additional column `dq_status` indicating the data quality status in the format </span>
<span class="sd">        &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_composite_key" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_composite_key</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_composite_key" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Determines if the given DataFrame satisfies the composite key condition based on the provided rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary defining the composite key rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A Dask DataFrame indicating whether the composite key condition is met.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_composite_key</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the given DataFrame satisfies the composite key condition based on the provided rule.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): A Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary defining the composite key rule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A Dask DataFrame indicating whether the composite key condition is met.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">are_unique</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_contained_in" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_contained_in</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_contained_in" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the values in a specified field
are not contained within a given list of allowed values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to check.
- 'check': The type of check being performed (e.g., "is_contained_in").
- 'value': A string representation of a list of allowed values (e.g., "[value1, value2]").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An additional column <code>dq_status</code> is added to indicate the rule violation in the format:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_contained_in</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the values in a specified field</span>
<span class="sd">    are not contained within a given list of allowed values.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;is_contained_in&quot;).</span>
<span class="sd">            - &#39;value&#39;: A string representation of a list of allowed values (e.g., &quot;[value1, value2]&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule.</span>
<span class="sd">        An additional column `dq_status` is added to indicate the rule violation in the format:</span>
<span class="sd">        &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">lst</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_date_after" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_date_after</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_date_after" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where a specified date field is 
earlier than a given reference date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should 
include:
- field (str): The name of the column to check.
- check (str): A descriptive label for the check (used in the 
  output status).
- date_str (str): The reference date as a string in a format 
  compatible with <code>pd.Timestamp</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows where the </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specified date field is earlier than the reference date. An additional </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column <code>dq_status</code> is added, which contains a string describing the </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rule violation in the format <code>field:check:date_str</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>rule</code> dictionary does not contain the required keys.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_date_after</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where a specified date field is </span>
<span class="sd">    earlier than a given reference date.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should </span>
<span class="sd">            include:</span>
<span class="sd">            - field (str): The name of the column to check.</span>
<span class="sd">            - check (str): A descriptive label for the check (used in the </span>
<span class="sd">              output status).</span>
<span class="sd">            - date_str (str): The reference date as a string in a format </span>
<span class="sd">              compatible with `pd.Timestamp`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows where the </span>
<span class="sd">        specified date field is earlier than the reference date. An additional </span>
<span class="sd">        column `dq_status` is added, which contains a string describing the </span>
<span class="sd">        rule violation in the format `field:check:date_str`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the `rule` dictionary does not contain the required keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">date_str</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date_str</span><span class="p">)</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_dt</span> <span class="o">&lt;</span> <span class="n">ref</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">date_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_date_before" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_date_before</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_date_before" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the values in a specified date column of a Dask DataFrame are before a given reference date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame containing the data to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The name of the column to check.
- 'check': A descriptive string for the check (e.g., "is_date_before").
- 'date_str': The reference date as a string in a format parsable by pandas.Timestamp.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows where the date in the specified column</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is after the reference date. An additional column 'dq_status' is added to indicate the validation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>status in the format "{field}:{check}:{date_str}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_date_before</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the values in a specified date column of a Dask DataFrame are before a given reference date.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame containing the data to be validated.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The name of the column to check.</span>
<span class="sd">            - &#39;check&#39;: A descriptive string for the check (e.g., &quot;is_date_before&quot;).</span>
<span class="sd">            - &#39;date_str&#39;: The reference date as a string in a format parsable by pandas.Timestamp.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows where the date in the specified column</span>
<span class="sd">        is after the reference date. An additional column &#39;dq_status&#39; is added to indicate the validation</span>
<span class="sd">        status in the format &quot;{field}:{check}:{date_str}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">date_str</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date_str</span><span class="p">)</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_dt</span> <span class="o">&gt;</span> <span class="n">ref</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">date_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_date_between" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_date_between</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_date_between" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where a date field does not fall within a specified range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame containing the data to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The name of the column in the DataFrame to check.
- 'check': A string representing the type of check (used for status annotation).
- 'val': A string representing the date range in the format "[start_date, end_date]".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows where the date field does not fall within the specified range.
          An additional column 'dq_status' is added to indicate the rule violation in the format
          "{field}:{check}:{val}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_date_between</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where a date field does not fall within a specified range.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame containing the data to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The name of the column in the DataFrame to check.</span>
<span class="sd">            - &#39;check&#39;: A string representing the type of check (used for status annotation).</span>
<span class="sd">            - &#39;val&#39;: A string representing the date range in the format &quot;[start_date, end_date]&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows where the date field does not fall within the specified range.</span>
<span class="sd">                      An additional column &#39;dq_status&#39; is added to indicate the rule violation in the format</span>
<span class="sd">                      &quot;{field}:{check}:{val}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">col_dt</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">col_dt</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_equal" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_equal</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_equal" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where a specified field does not equal a given value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to be checked.
- 'check': The type of check to perform (expected to be 'equal' for this function).
- 'value': The value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing rows that violate the equality rule.
          An additional column <code>dq_status</code> is added, indicating the rule details
          in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_equal</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where a specified field does not equal a given value.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to be checked.</span>
<span class="sd">            - &#39;check&#39;: The type of check to perform (expected to be &#39;equal&#39; for this function).</span>
<span class="sd">            - &#39;value&#39;: The value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing rows that violate the equality rule.</span>
<span class="sd">                      An additional column `dq_status` is added, indicating the rule details</span>
<span class="sd">                      in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_equal_than" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_equal_than" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the specified field does not equal the given value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to check.
- 'check': The type of check being performed (expected to be 'equal' for this function).
- 'value': The value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing rows that violate the equality rule. 
          An additional column <code>dq_status</code> is added, indicating the rule details 
          in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the specified field does not equal the given value.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (expected to be &#39;equal&#39; for this function).</span>
<span class="sd">            - &#39;value&#39;: The value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing rows that violate the equality rule. </span>
<span class="sd">                      An additional column `dq_status` is added, indicating the rule details </span>
<span class="sd">                      in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_future_date" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_future_date</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_future_date" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks for rows in a Dask DataFrame where the specified date field contains a future date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It is expected to include:
- field: The name of the column to check.
- check: A descriptive label for the check (used in the output).
- _: Additional parameters (ignored in this function).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows where the date in the specified</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>field is in the future. An additional column <code>dq_status</code> is added to indicate the status</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of the validation in the format: "<field>:<check>:<current_date>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function coerces the specified column to datetime format, and invalid parsing results
  in NaT (Not a Time).</li>
<li>Rows with NaT in the specified column are excluded from the output.</li>
<li>The current date is determined using the system's local date.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_future_date</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks for rows in a Dask DataFrame where the specified date field contains a future date.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to validate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It is expected to include:</span>
<span class="sd">            - field: The name of the column to check.</span>
<span class="sd">            - check: A descriptive label for the check (used in the output).</span>
<span class="sd">            - _: Additional parameters (ignored in this function).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows where the date in the specified</span>
<span class="sd">        field is in the future. An additional column `dq_status` is added to indicate the status</span>
<span class="sd">        of the validation in the format: &quot;&lt;field&gt;:&lt;check&gt;:&lt;current_date&gt;&quot;.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function coerces the specified column to datetime format, and invalid parsing results</span>
<span class="sd">          in NaT (Not a Time).</span>
<span class="sd">        - Rows with NaT in the specified column are excluded from the output.</span>
<span class="sd">        - The current date is determined using the system&#39;s local date.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_dt</span> <span class="o">&gt;</span> <span class="n">today</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">today</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_greater_or_equal_than" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_greater_or_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_greater_or_equal_than" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where a specified field's value 
is less than a given threshold, and annotates the resulting rows with a 
data quality status.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should 
         include the following keys:
         - 'field': The column name in the DataFrame to check.
         - 'check': The type of check being performed (e.g., 'greater_or_equal').
         - 'value': The threshold value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows that 
          violate the rule, with an additional column <code>dq_status</code> 
          indicating the field, check type, and threshold value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_greater_or_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where a specified field&#39;s value </span>
<span class="sd">    is less than a given threshold, and annotates the resulting rows with a </span>
<span class="sd">    data quality status.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should </span>
<span class="sd">                     include the following keys:</span>
<span class="sd">                     - &#39;field&#39;: The column name in the DataFrame to check.</span>
<span class="sd">                     - &#39;check&#39;: The type of check being performed (e.g., &#39;greater_or_equal&#39;).</span>
<span class="sd">                     - &#39;value&#39;: The threshold value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows that </span>
<span class="sd">                      violate the rule, with an additional column `dq_status` </span>
<span class="sd">                      indicating the field, check type, and threshold value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_greater_than" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_greater_than</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_greater_than" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the value in a specified field
is greater than a given threshold and annotates the result with a data quality status.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The column name to check.
- 'check' (str): The type of check being performed (e.g., 'greater_than').
- 'value' (numeric): The threshold value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A filtered DataFrame containing rows that violate the rule,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> indicating the rule details in the format</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_greater_than</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the value in a specified field</span>
<span class="sd">    is greater than a given threshold and annotates the result with a data quality status.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to check.</span>
<span class="sd">            - &#39;check&#39; (str): The type of check being performed (e.g., &#39;greater_than&#39;).</span>
<span class="sd">            - &#39;value&#39; (numeric): The threshold value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A filtered DataFrame containing rows that violate the rule,</span>
<span class="sd">        with an additional column `dq_status` indicating the rule details in the format</span>
<span class="sd">        &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_legit" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_legit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_legit" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates a Dask DataFrame against a specified rule and returns rows that violate the rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the validation rule. It should include:
- 'field': The column name in the DataFrame to validate.
- 'check': The type of validation check (e.g., regex, condition).
- 'value': The value or pattern to validate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing rows that violate the rule, with an additional</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column <code>dq_status</code> indicating the field, check, and value of the failed validation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_legit</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a Dask DataFrame against a specified rule and returns rows that violate the rule.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame to validate.</span>
<span class="sd">        rule (dict): A dictionary containing the validation rule. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to validate.</span>
<span class="sd">            - &#39;check&#39;: The type of validation check (e.g., regex, condition).</span>
<span class="sd">            - &#39;value&#39;: The value or pattern to validate against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing rows that violate the rule, with an additional</span>
<span class="sd">        column `dq_status` indicating the field, check, and value of the failed validation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\S+$&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_less_or_equal_than" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_less_or_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_less_or_equal_than" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the value in a specified field
is greater than a given threshold, violating a "less or equal than" rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to be checked.
- 'check': The type of check being performed (e.g., "less_or_equal_than").
- 'value': The threshold value to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing only the rows that violate the rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An additional column <code>dq_status</code> is added to indicate the rule violation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_less_or_equal_than</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the value in a specified field</span>
<span class="sd">    is greater than a given threshold, violating a &quot;less or equal than&quot; rule.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to be checked.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;less_or_equal_than&quot;).</span>
<span class="sd">            - &#39;value&#39;: The threshold value to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing only the rows that violate the rule.</span>
<span class="sd">        An additional column `dq_status` is added to indicate the rule violation</span>
<span class="sd">        in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_less_than" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_less_than</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_less_than" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the value in a specified field
is greater than or equal to a given threshold, and marks them with a data quality status.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field' (str): The column name to check.
- 'check' (str): The type of check being performed (e.g., "less_than").
- 'value' (numeric): The threshold value for the check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> indicating the rule that was violated in the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_less_than</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the value in a specified field</span>
<span class="sd">    is greater than or equal to a given threshold, and marks them with a data quality status.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39; (str): The column name to check.</span>
<span class="sd">            - &#39;check&#39; (str): The type of check being performed (e.g., &quot;less_than&quot;).</span>
<span class="sd">            - &#39;value&#39; (numeric): The threshold value for the check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule,</span>
<span class="sd">        with an additional column `dq_status` indicating the rule that was violated in the</span>
<span class="sd">        format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_negative" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_negative</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_negative" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Identifies rows in a Dask DataFrame where the specified field does not satisfy a "negative" check.</p>
<p>This function filters the DataFrame to find rows where the value in the specified field
is greater than or equal to 0 (i.e., not negative). It then assigns a new column <code>dq_status</code>
to indicate the rule that was violated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- <code>field</code> (str): The name of the column to check.
- <code>check</code> (str): The type of check being performed (e.g., "negative").
- <code>value</code> (any): The expected value or condition for the check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> describing the violation in the format</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_negative</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifies rows in a Dask DataFrame where the specified field does not satisfy a &quot;negative&quot; check.</span>

<span class="sd">    This function filters the DataFrame to find rows where the value in the specified field</span>
<span class="sd">    is greater than or equal to 0 (i.e., not negative). It then assigns a new column `dq_status`</span>
<span class="sd">    to indicate the rule that was violated.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - `field` (str): The name of the column to check.</span>
<span class="sd">            - `check` (str): The type of check being performed (e.g., &quot;negative&quot;).</span>
<span class="sd">            - `value` (any): The expected value or condition for the check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing only the rows that violate the rule,</span>
<span class="sd">        with an additional column `dq_status` describing the violation in the format</span>
<span class="sd">        &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_past_date" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_past_date</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_past_date" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the values in a specified date column of a Dask DataFrame are in the past.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame containing the data to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It is expected to include
         the field name to check, the check type, and additional parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A Dask DataFrame containing rows where the date in the specified column
          is in the past. An additional column <code>dq_status</code> is added to indicate
          the field, check type, and the date of the check in the format
          "field:check:YYYY-MM-DD".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_past_date</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the values in a specified date column of a Dask DataFrame are in the past.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame containing the data to be checked.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It is expected to include</span>
<span class="sd">                     the field name to check, the check type, and additional parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A Dask DataFrame containing rows where the date in the specified column</span>
<span class="sd">                      is in the past. An additional column `dq_status` is added to indicate</span>
<span class="sd">                      the field, check type, and the date of the check in the format</span>
<span class="sd">                      &quot;field:check:YYYY-MM-DD&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_dt</span> <span class="o">&lt;</span> <span class="n">today</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">today</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_positive" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_positive</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_positive" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks if the values in a specified field of a Dask DataFrame are positive.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The name of the field to check.
- 'check': The type of check being performed (e.g., "is_positive").
- 'value': The expected value or condition (e.g., "0").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows where the specified field has </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>negative values, with an additional column <code>dq_status</code> indicating the </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>field, check, and value that failed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_positive</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the values in a specified field of a Dask DataFrame are positive.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to validate.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The name of the field to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;is_positive&quot;).</span>
<span class="sd">            - &#39;value&#39;: The expected value or condition (e.g., &quot;0&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows where the specified field has </span>
<span class="sd">        negative values, with an additional column `dq_status` indicating the </span>
<span class="sd">        field, check, and value that failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_primary_key" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_primary_key</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_primary_key" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Determines if the specified rule identifies a primary key in the given Dask DataFrame.</p>
<p>This function checks whether the combination of columns specified in the rule
results in unique values across the DataFrame, effectively identifying a primary key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary defining the rule to check for primary key uniqueness.
         Typically, this includes the column(s) to be evaluated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A Dask DataFrame indicating whether the rule satisfies the primary key condition.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_primary_key</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the specified rule identifies a primary key in the given Dask DataFrame.</span>

<span class="sd">    This function checks whether the combination of columns specified in the rule</span>
<span class="sd">    results in unique values across the DataFrame, effectively identifying a primary key.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame to evaluate.</span>
<span class="sd">        rule (dict): A dictionary defining the rule to check for primary key uniqueness.</span>
<span class="sd">                     Typically, this includes the column(s) to be evaluated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A Dask DataFrame indicating whether the rule satisfies the primary key condition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">is_unique</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.is_unique" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_unique</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.is_unique" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Checks for uniqueness of a specified field in a Dask DataFrame based on a given rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame to check for uniqueness.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It is expected to include:
- 'field': The column name to check for uniqueness.
- 'check': The type of check being performed (e.g., "unique").
- 'value': Additional value or metadata related to the check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows that violate the uniqueness rule, </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with an additional column <code>dq_status</code> indicating the rule that was violated </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in the format "{field}:{check}:{value}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_unique</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks for uniqueness of a specified field in a Dask DataFrame based on a given rule.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame to check for uniqueness.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It is expected to include:</span>
<span class="sd">            - &#39;field&#39;: The column name to check for uniqueness.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;unique&quot;).</span>
<span class="sd">            - &#39;value&#39;: Additional value or metadata related to the check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows that violate the uniqueness rule, </span>
<span class="sd">        with an additional column `dq_status` indicating the rule that was violated </span>
<span class="sd">        in the format &quot;{field}:{check}:{value}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">dup_vals</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dup_vals</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.not_contained_in" class="doc doc-heading">
            <code class=" language-python"><span class="n">not_contained_in</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.not_contained_in" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame to identify rows where the specified field's value is 
contained in a given list, and assigns a data quality status to the resulting rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be filtered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the rule parameters. It should include:
- 'field': The column name in the DataFrame to check.
- 'check': The type of check being performed (e.g., "not_contained_in").
- 'value': A string representation of a list of values to check against, 
  formatted as "[value1, value2, ...]".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new DataFrame containing only the rows where the specified </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>field's value is in the provided list, with an additional column <code>dq_status</code> </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indicating the rule applied in the format "field:check:value".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">not_contained_in</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame to identify rows where the specified field&#39;s value is </span>
<span class="sd">    contained in a given list, and assigns a data quality status to the resulting rows.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be filtered.</span>
<span class="sd">        rule (dict): A dictionary containing the rule parameters. It should include:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to check.</span>
<span class="sd">            - &#39;check&#39;: The type of check being performed (e.g., &quot;not_contained_in&quot;).</span>
<span class="sd">            - &#39;value&#39;: A string representation of a list of values to check against, </span>
<span class="sd">              formatted as &quot;[value1, value2, ...]&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new DataFrame containing only the rows where the specified </span>
<span class="sd">        field&#39;s value is in the provided list, with an additional column `dq_status` </span>
<span class="sd">        indicating the rule applied in the format &quot;field:check:value&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">lst</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.satisfies" class="doc doc-heading">
            <code class=" language-python"><span class="n">satisfies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.satisfies" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filters a Dask DataFrame based on a rule and returns rows that do not satisfy the rule.</p>
<p>The function evaluates a rule on the given Dask DataFrame and identifies rows that
violate the rule. The rule is specified as a dictionary containing a field, a check,
and a value. The rule's logical expression is converted to Python syntax for evaluation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to be filtered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary specifying the rule to evaluate. It should contain:
- 'field': The column name in the DataFrame to evaluate.
- 'check': The type of check or condition to apply.
- 'value': The value or expression to evaluate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A new Dask DataFrame containing rows that do not satisfy the rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An additional column <code>dq_status</code> is added, which contains a string in the format</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"{field}:{check}:{value}" to indicate the rule that was violated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import dask.dataframe as dd
data = {'col1': [1, 2, 3], 'col2': [4, 5, 6]}
df = dd.from_pandas(pd.DataFrame(data), npartitions=1)
rule = {'field': 'col1', 'check': '&gt;', 'value': '2'}
result = satisfies(df, rule)
result.compute()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">satisfies</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters a Dask DataFrame based on a rule and returns rows that do not satisfy the rule.</span>

<span class="sd">    The function evaluates a rule on the given Dask DataFrame and identifies rows that</span>
<span class="sd">    violate the rule. The rule is specified as a dictionary containing a field, a check,</span>
<span class="sd">    and a value. The rule&#39;s logical expression is converted to Python syntax for evaluation.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to be filtered.</span>
<span class="sd">        rule (dict): A dictionary specifying the rule to evaluate. It should contain:</span>
<span class="sd">            - &#39;field&#39;: The column name in the DataFrame to evaluate.</span>
<span class="sd">            - &#39;check&#39;: The type of check or condition to apply.</span>
<span class="sd">            - &#39;value&#39;: The value or expression to evaluate against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A new Dask DataFrame containing rows that do not satisfy the rule.</span>
<span class="sd">        An additional column `dq_status` is added, which contains a string in the format</span>
<span class="sd">        &quot;{field}:{check}:{value}&quot; to indicate the rule that was violated.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import dask.dataframe as dd</span>
<span class="sd">        &gt;&gt;&gt; data = {&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]}</span>
<span class="sd">        &gt;&gt;&gt; df = dd.from_pandas(pd.DataFrame(data), npartitions=1)</span>
<span class="sd">        &gt;&gt;&gt; rule = {&#39;field&#39;: &#39;col1&#39;, &#39;check&#39;: &#39;&gt;&#39;, &#39;value&#39;: &#39;2&#39;}</span>
<span class="sd">        &gt;&gt;&gt; result = satisfies(df, rule)</span>
<span class="sd">        &gt;&gt;&gt; result.compute()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">py_expr</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">py_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?&lt;![=!&lt;&gt;])=(?!=)&quot;</span><span class="p">,</span> <span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="n">py_expr</span><span class="p">)</span>
    <span class="n">py_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\bAND\b&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="n">py_expr</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="n">py_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\bOR\b&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">py_expr</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_filter_viol</span><span class="p">(</span><span class="n">pdf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">py_expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>

    <span class="n">meta</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_meta</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">_filter_viol</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.summarize" class="doc doc-heading">
            <code class=" language-python"><span class="n">summarize</span><span class="p">(</span><span class="n">qc_ddf</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">total_rows</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.summarize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Summarizes quality check results by evaluating rules against a Dask DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qc_ddf</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Dask DataFrame containing quality check results. 
The DataFrame must include a "dq_status" column with rule violations 
in the format "column:rule:value".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries representing the rules to be 
evaluated. Each dictionary should include keys such as "column", 
"rule", "value", and "pass_threshold".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_rows</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total number of rows in the original dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A summarized Pandas DataFrame containing the following columns:
- id: Unique identifier for each rule evaluation.
- timestamp: Timestamp of the summary generation.
- check: The type of check performed (e.g., "Quality Check").
- level: The severity level of the check (e.g., "WARNING").
- column: The column name associated with the rule.
- rule: The rule being evaluated.
- value: The value associated with the rule.
- rows: The total number of rows in the dataset.
- violations: The number of rows that violated the rule.
- pass_rate: The proportion of rows that passed the rule.
- pass_threshold: The threshold for passing the rule.
- status: The status of the rule evaluation ("PASS" or "FAIL").</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">qc_ddf</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">total_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summarizes quality check results by evaluating rules against a Dask DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        qc_ddf (dd.DataFrame): A Dask DataFrame containing quality check results. </span>
<span class="sd">            The DataFrame must include a &quot;dq_status&quot; column with rule violations </span>
<span class="sd">            in the format &quot;column:rule:value&quot;.</span>
<span class="sd">        rules (list[dict]): A list of dictionaries representing the rules to be </span>
<span class="sd">            evaluated. Each dictionary should include keys such as &quot;column&quot;, </span>
<span class="sd">            &quot;rule&quot;, &quot;value&quot;, and &quot;pass_threshold&quot;.</span>
<span class="sd">        total_rows (int): The total number of rows in the original dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A summarized Pandas DataFrame containing the following columns:</span>
<span class="sd">            - id: Unique identifier for each rule evaluation.</span>
<span class="sd">            - timestamp: Timestamp of the summary generation.</span>
<span class="sd">            - check: The type of check performed (e.g., &quot;Quality Check&quot;).</span>
<span class="sd">            - level: The severity level of the check (e.g., &quot;WARNING&quot;).</span>
<span class="sd">            - column: The column name associated with the rule.</span>
<span class="sd">            - rule: The rule being evaluated.</span>
<span class="sd">            - value: The value associated with the rule.</span>
<span class="sd">            - rows: The total number of rows in the dataset.</span>
<span class="sd">            - violations: The number of rows that violated the rule.</span>
<span class="sd">            - pass_rate: The proportion of rows that passed the rule.</span>
<span class="sd">            - pass_threshold: The threshold for passing the rule.</span>
<span class="sd">            - status: The status of the rule evaluation (&quot;PASS&quot; or &quot;FAIL&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">qc_ddf</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dq_status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;dq_status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">split</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="n">viol_count</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">split</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;violations&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">rules_df</span> <span class="o">=</span> <span class="n">_rules_to_df</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

    <span class="n">rules_df</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rules_df</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">viol_count</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">viol_count</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">rules_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">viol_count</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">violations</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;violations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
            <span class="n">rows</span><span class="o">=</span><span class="n">total_rows</span><span class="p">,</span>
            <span class="n">pass_rate</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">total_rows</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;violations&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pass_rate&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pass_threshold&quot;</span><span class="p">],</span> <span class="s2">&quot;PASS&quot;</span><span class="p">,</span> <span class="s2">&quot;FAIL&quot;</span>
            <span class="p">),</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">check</span><span class="o">=</span><span class="s2">&quot;Quality Check&quot;</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">summary</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="s2">&quot;id&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check&quot;</span><span class="p">,</span>
            <span class="s2">&quot;level&quot;</span><span class="p">,</span>
            <span class="s2">&quot;column&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rows&quot;</span><span class="p">,</span>
            <span class="s2">&quot;violations&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pass_rate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pass_threshold&quot;</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.validate" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.validate" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validate a Dask DataFrame against a set of rules and return the aggregated results 
and raw violations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of validation rules. Each rule is a dictionary 
containing the following keys:
- "check_type" (str): The name of the validation function to execute.
- "value" (optional): The value to be used in the validation function.
- "execute" (optional, bool): Whether to execute the rule. Defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dask.dataframe.DataFrame">DataFrame</span>, <span title="dask.dataframe.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[dd.DataFrame, dd.DataFrame]: 
- The first DataFrame contains the aggregated validation results, 
  with a concatenated "dq_status" column indicating the validation status.
- The second DataFrame contains the raw violations for each rule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate a Dask DataFrame against a set of rules and return the aggregated results </span>
<span class="sd">    and raw violations.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The input Dask DataFrame to validate.</span>
<span class="sd">        rules (list[dict]): A list of validation rules. Each rule is a dictionary </span>
<span class="sd">            containing the following keys:</span>
<span class="sd">            - &quot;check_type&quot; (str): The name of the validation function to execute.</span>
<span class="sd">            - &quot;value&quot; (optional): The value to be used in the validation function.</span>
<span class="sd">            - &quot;execute&quot; (optional, bool): Whether to execute the rule. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[dd.DataFrame, dd.DataFrame]: </span>
<span class="sd">            - The first DataFrame contains the aggregated validation results, </span>
<span class="sd">              with a concatenated &quot;dq_status&quot; column indicating the validation status.</span>
<span class="sd">            - The second DataFrame contains the raw violations for each rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">empty</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;dq_status&quot;</span><span class="p">]),</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">raw_df</span> <span class="o">=</span> <span class="n">empty</span>

    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;check_type&quot;</span><span class="p">]</span>
        <span class="n">func</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rule_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown rule: </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">raw_val</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">__convert_value</span><span class="p">(</span><span class="n">raw_val</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">raw_val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">raw_val</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">raw_val</span>

        <span class="n">viol</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
        <span class="n">raw_df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">raw_df</span><span class="p">,</span> <span class="n">viol</span><span class="p">],</span> <span class="n">interleave_partitions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">group_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;dq_status&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_concat_status</span><span class="p">(</span><span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="p">])</span>

    <span class="n">agg_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">raw_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_cols</span><span class="p">)</span>
        <span class="o">.</span><span class="n">dq_status</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_concat_status</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;dq_status&quot;</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">))</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">agg_df</span><span class="p">,</span> <span class="n">raw_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.validate_date_format" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate_date_format</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.validate_date_format" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates the date format of a specified column in a Dask DataFrame.</p>
<p>This function checks whether the values in a specified column of the 
DataFrame conform to a given date format. Rows with invalid date formats 
are returned with an additional column indicating the validation status.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the validation rule. It should 
         include the following keys:
         - 'field': The name of the column to validate.
         - 'check': A string describing the validation check.
         - 'fmt': The expected date format (e.g., '%Y-%m-%d').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dd.DataFrame: A DataFrame containing rows where the date format 
          validation failed. An additional column <code>dq_status</code> 
          is added, which contains a string describing the 
          validation status in the format "{field}:{check}:{fmt}".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_date_format</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the date format of a specified column in a Dask DataFrame.</span>

<span class="sd">    This function checks whether the values in a specified column of the </span>
<span class="sd">    DataFrame conform to a given date format. Rows with invalid date formats </span>
<span class="sd">    are returned with an additional column indicating the validation status.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame to validate.</span>
<span class="sd">        rule (dict): A dictionary containing the validation rule. It should </span>
<span class="sd">                     include the following keys:</span>
<span class="sd">                     - &#39;field&#39;: The name of the column to validate.</span>
<span class="sd">                     - &#39;check&#39;: A string describing the validation check.</span>
<span class="sd">                     - &#39;fmt&#39;: The expected date format (e.g., &#39;%Y-%m-%d&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dd.DataFrame: A DataFrame containing rows where the date format </span>
<span class="sd">                      validation failed. An additional column `dq_status` </span>
<span class="sd">                      is added, which contains a string describing the </span>
<span class="sd">                      validation status in the format &quot;{field}:{check}:{fmt}&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">check</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="n">__extract_params</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
    <span class="n">col_dt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="n">viol</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_dt</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">viol</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dq_status</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="sumeh.engine.dask_engine.validate_schema" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate_schema</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></code>

<a href="#sumeh.engine.dask_engine.validate_schema" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Validates the schema of a Dask DataFrame against an expected schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="dask.dataframe.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dask DataFrame whose schema is to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries representing the expected schema.
Each dictionary should define the expected column name and its properties.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating
whether the schema matches the expected schema, and the second element is a list of
tuples containing mismatched column names and their respective issues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sumeh/engine/dask_engine.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_schema</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the schema of a Dask DataFrame against an expected schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (dd.DataFrame): The Dask DataFrame whose schema is to be validated.</span>
<span class="sd">        expected (List[Dict[str, Any]]): A list of dictionaries representing the expected schema.</span>
<span class="sd">            Each dictionary should define the expected column name and its properties.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bool, List[Tuple[str, str]]]: A tuple where the first element is a boolean indicating</span>
<span class="sd">            whether the schema matches the expected schema, and the second element is a list of</span>
<span class="sd">            tuples containing mismatched column names and their respective issues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">__dask_schema_to_list</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__compare_schemas</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>