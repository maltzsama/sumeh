
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Library for Data Quality checks">
      
      
        <meta name="author" content="Demetrius Albuquerque">
      
      
      
        <link rel="prev" href="../dask/">
      
      
        <link rel="next" href="../pandas/">
      
      
      <link rel="icon" href="../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>duckDB - Sumeh DQ — Unified Data Quality Framework</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#duckdb" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-header__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../../img/sumeh.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sumeh DQ — Unified Data Quality Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              duckDB
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Sumeh DQ — Unified Data Quality Framework" class="md-nav__button md-logo" aria-label="Sumeh DQ — Unified Data Quality Framework" data-md-component="logo">
      
  <img src="../../../img/sumeh.svg" alt="logo">

    </a>
    Sumeh DQ — Unified Data Quality Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    engines
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            engines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    engine overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bigquery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bigquery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dask
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    duckDB
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    duckDB
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine" class="md-nav__link">
    <span class="md-ellipsis">
      duckdb_engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="duckdb_engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__RuleCtx" class="md-nav__link">
    <span class="md-ellipsis">
      __RuleCtx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__escape_single_quotes" class="md-nav__link">
    <span class="md-ellipsis">
      __escape_single_quotes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__format_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      __format_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.extract_schema" class="md-nav__link">
    <span class="md-ellipsis">
      extract_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_cardinality" class="md-nav__link">
    <span class="md-ellipsis">
      has_cardinality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_entropy" class="md-nav__link">
    <span class="md-ellipsis">
      has_entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_infogain" class="md-nav__link">
    <span class="md-ellipsis">
      has_infogain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_max" class="md-nav__link">
    <span class="md-ellipsis">
      has_max
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_mean" class="md-nav__link">
    <span class="md-ellipsis">
      has_mean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_min" class="md-nav__link">
    <span class="md-ellipsis">
      has_min
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_std" class="md-nav__link">
    <span class="md-ellipsis">
      has_std
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_sum" class="md-nav__link">
    <span class="md-ellipsis">
      has_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_row_level" class="md-nav__link">
    <span class="md-ellipsis">
      validate_row_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_table_level" class="md-nav__link">
    <span class="md-ellipsis">
      validate_table_level
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pandas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polars
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pyspark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pyspark
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    generators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dash
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine" class="md-nav__link">
    <span class="md-ellipsis">
      duckdb_engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="duckdb_engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__RuleCtx" class="md-nav__link">
    <span class="md-ellipsis">
      __RuleCtx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__escape_single_quotes" class="md-nav__link">
    <span class="md-ellipsis">
      __escape_single_quotes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.__format_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      __format_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.extract_schema" class="md-nav__link">
    <span class="md-ellipsis">
      extract_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_cardinality" class="md-nav__link">
    <span class="md-ellipsis">
      has_cardinality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_entropy" class="md-nav__link">
    <span class="md-ellipsis">
      has_entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_infogain" class="md-nav__link">
    <span class="md-ellipsis">
      has_infogain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_max" class="md-nav__link">
    <span class="md-ellipsis">
      has_max
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_mean" class="md-nav__link">
    <span class="md-ellipsis">
      has_mean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_min" class="md-nav__link">
    <span class="md-ellipsis">
      has_min
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_std" class="md-nav__link">
    <span class="md-ellipsis">
      has_std
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.has_sum" class="md-nav__link">
    <span class="md-ellipsis">
      has_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_row_level" class="md-nav__link">
    <span class="md-ellipsis">
      validate_row_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      validate_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sumeh.engines.duckdb_engine.validate_table_level" class="md-nav__link">
    <span class="md-ellipsis">
      validate_table_level
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="duckdb">duckdb<a class="headerlink" href="#duckdb" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="sumeh.engines.duckdb_engine" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sumeh.engines.duckdb_engine</span>


<a href="#sumeh.engines.duckdb_engine" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>This module provides utilities for generating and validating SQL expressions
and data quality rules using DuckDB. It includes functions for building SQL
expressions, validating dataframes against rules, summarizing rule violations,
and schema validation.</p>


<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="__RuleCtx


  
      dataclass
   (sumeh.engines.duckdb_engine.__RuleCtx)" href="#sumeh.engines.duckdb_engine.__RuleCtx">__RuleCtx</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>A dataclass representing the context required to generate SQL
      expressions for data quality rules.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__escape_single_quotes (sumeh.engines.duckdb_engine.__escape_single_quotes)" href="#sumeh.engines.duckdb_engine.__escape_single_quotes">__escape_single_quotes</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Escapes single quotes in a string for SQL compatibility.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__format_sequence (sumeh.engines.duckdb_engine.__format_sequence)" href="#sumeh.engines.duckdb_engine.__format_sequence">__format_sequence</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Formats a sequence (list, tuple, or string) into a SQL-compatible representation for IN/NOT IN clauses.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_complete">_is_complete</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column is not NULL.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._are_complete">_are_complete</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if all columns in a list are not NULL.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_unique">_is_unique</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column has unique values.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._are_unique">_are_unique</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a combination of columns has unique values.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_greater_than">_is_greater_than</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is greater than a given value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_less_than">_is_less_than</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is less than a given value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_greater_or_equal_than">_is_greater_or_equal_than</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is greater than or equal to a given value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_less_or_equal_than">_is_less_or_equal_than</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is less than or equal to a given value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_equal_than">_is_equal_than</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is equal to a given value.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_between">_is_between</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is between two values.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._has_pattern">_has_pattern</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value matches a regular expression pattern.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._is_contained_in">_is_contained_in</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is in a given sequence.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._not_contained_in">_not_contained_in</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression to check if a column's value is not in a given sequence.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._satisfies">_satisfies</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a SQL expression based on a custom condition provided as a string.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="sumeh.engines.duckdb_engine._build_union_sql">_build_union_sql</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Builds a SQL query that combines multiple rule-based conditions into a UNION ALL query.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate (sumeh.engines.duckdb_engine.validate)" href="#sumeh.engines.duckdb_engine.validate">validate</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Validates a DuckDB dataframe against a set of rules and returns the results.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="summarize (sumeh.engines.duckdb_engine.summarize)" href="#sumeh.engines.duckdb_engine.summarize">summarize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Summarizes rule violations and calculates pass rates for each rule.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="validate_schema (sumeh.engines.duckdb_engine.validate_schema)" href="#sumeh.engines.duckdb_engine.validate_schema">validate_schema</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Validates the schema of a DuckDB table against an expected schema.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="sumeh.engines.duckdb_engine.__RuleCtx" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">__RuleCtx</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#sumeh.engines.duckdb_engine.__RuleCtx" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__RuleCtx</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


        <p>Context class used to generate SQL expressions for data quality rules.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sumeh.engines.duckdb_engine.__RuleCtx.column">column</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to apply the rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sumeh.engines.duckdb_engine.__RuleCtx.value">value</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value associated with the rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sumeh.engines.duckdb_engine.__RuleCtx.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the rule (check_type).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.__escape_single_quotes" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__escape_single_quotes</span>


<a href="#sumeh.engines.duckdb_engine.__escape_single_quotes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__escape_single_quotes</span><span class="p">(</span><span class="n">txt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Escapes single quotes for SQL compatibility.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.__format_sequence" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__format_sequence</span>


<a href="#sumeh.engines.duckdb_engine.__format_sequence" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__format_sequence</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Formats a sequence into a list of values for IN/NOT IN clauses.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input value (string, list, or tuple).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: List of formatted values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.extract_schema" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">extract_schema</span>


<a href="#sumeh.engines.duckdb_engine.extract_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extract_schema</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts schema from DuckDB table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]: List of dictionaries containing field information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_cardinality" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_cardinality</span>


<a href="#sumeh.engines.duckdb_engine.has_cardinality" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_cardinality</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the cardinality meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_entropy" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_entropy</span>


<a href="#sumeh.engines.duckdb_engine.has_entropy" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_entropy</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the entropy meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_infogain" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_infogain</span>


<a href="#sumeh.engines.duckdb_engine.has_infogain" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_infogain</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the information gain meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_max" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_max</span>


<a href="#sumeh.engines.duckdb_engine.has_max" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_max</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the maximum value meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_mean" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_mean</span>


<a href="#sumeh.engines.duckdb_engine.has_mean" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_mean</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the mean meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_min" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_min</span>


<a href="#sumeh.engines.duckdb_engine.has_min" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_min</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the minimum value meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_std" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_std</span>


<a href="#sumeh.engines.duckdb_engine.has_std" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_std</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the standard deviation meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.has_sum" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_sum</span>


<a href="#sumeh.engines.duckdb_engine.has_sum" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">has_sum</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if the sum meets expectations.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.summarize" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">summarize</span>


<a href="#sumeh.engines.duckdb_engine.summarize" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">summarize</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RuleDef</span><span class="p">],</span> <span class="n">total_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">df_with_errors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DuckDBPyRelation</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">table_error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DuckDBPyRelation</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dk</span><span class="o">.</span><span class="n">DuckDBPyRelation</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Summarizes validation results from both row-level and table-level checks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="sumeh.core.rules.rule_model.RuleDef">RuleDef</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of all validation rules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_rows</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of rows in the input relation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_with_errors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relation with row-level violations.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_error</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relation with table-level results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DuckDBPyRelation</code></td>            <td>
                  <code><span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Summary relation with aggregated validation metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.validate" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate</span>


<a href="#sumeh.engines.duckdb_engine.validate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">df_rel</span><span class="p">:</span> <span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RuleDef</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">DuckDBPyRelation</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Main validation function that orchestrates row-level and table-level validations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_rel</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DuckDB relation to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="sumeh.core.rules.rule_model.RuleDef">RuleDef</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of all validation rules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>, <span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>, <span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[DuckDBPyRelation, DuckDBPyRelation, DuckDBPyRelation]:
- Relation with row-level violations and dq_status
- Raw row-level violations relation
- Table-level summary relation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.validate_row_level" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_row_level</span>


<a href="#sumeh.engines.duckdb_engine.validate_row_level" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_row_level</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">df_rel</span><span class="p">:</span> <span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RuleDef</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">DuckDBPyRelation</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validates DataFrame at row level using specified rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_rel</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DuckDB relation to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="sumeh.core.rules.rule_model.RuleDef">RuleDef</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of row-level validation rules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>, <span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[DuckDBPyRelation, DuckDBPyRelation]:
- Relation with violations and dq_status column
- Raw violations relation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.validate_schema" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_schema</span>


<a href="#sumeh.engines.duckdb_engine.validate_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_schema</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validates the schema of a DuckDB table against an expected schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected schema.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="bool">bool</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[bool, List[Dict[str, Any]]]:
- Boolean indicating whether the schema matches
- List of schema errors/mismatches</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="sumeh.engines.duckdb_engine.validate_table_level" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_table_level</span>


<a href="#sumeh.engines.duckdb_engine.validate_table_level" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_table_level</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">DuckDBPyConnection</span><span class="p">,</span> <span class="n">df_rel</span><span class="p">:</span> <span class="n">DuckDBPyRelation</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RuleDef</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dk</span><span class="o">.</span><span class="n">DuckDBPyRelation</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validates DataFrame at table level using specified rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyConnection">DuckDBPyConnection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_rel</code>
            </td>
            <td>
                  <code><span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DuckDB relation to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="sumeh.core.rules.rule_model.RuleDef">RuleDef</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of table-level validation rules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DuckDBPyRelation</code></td>            <td>
                  <code><span title="duckdb.DuckDBPyRelation">DuckDBPyRelation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Summary relation with validation results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>